Namespace(time_steps=-1, dataset='Flights', GPU_ID=0, epochs=200, val_freq=1, test_freq=1, batch_size=512, featureless=True, early_stop=10, residual=True, neg_sample_size=10, walk_len=20, neg_weight=1.0, learning_rate=0.01, spatial_drop=0.1, temporal_drop=0.5, weight_decay=0.0005, structural_head_config='16,8,8', structural_layer_config='128', temporal_head_config='16', temporal_layer_config='128', position_ffn='True', window=-1)
Loaded 21 graphs 
Computing training pairs ...
# nodes with random walk samples: 8685
# sampled pairs: 24530468
# nodes with random walk samples: 8908
# sampled pairs: 25141562
# nodes with random walk samples: 8527
# sampled pairs: 23945668
# nodes with random walk samples: 7671
# sampled pairs: 21374310
# nodes with random walk samples: 7407
# sampled pairs: 20472346
# nodes with random walk samples: 7397
# sampled pairs: 20371394
# nodes with random walk samples: 7595
# sampled pairs: 20971598
# nodes with random walk samples: 7299
# sampled pairs: 20116244
# nodes with random walk samples: 7783
# sampled pairs: 21520530
# nodes with random walk samples: 7974
# sampled pairs: 22051030
# nodes with random walk samples: 8269
# sampled pairs: 22984960
# nodes with random walk samples: 8307
# sampled pairs: 23082180
# nodes with random walk samples: 8420
# sampled pairs: 23416586
# nodes with random walk samples: 8678
# sampled pairs: 24225302
# nodes with random walk samples: 8668
# sampled pairs: 24157908
# nodes with random walk samples: 9161
# sampled pairs: 25633614
# nodes with random walk samples: 8816
# sampled pairs: 24652428
# nodes with random walk samples: 9366
# sampled pairs: 26287200
# nodes with random walk samples: 9248
# sampled pairs: 25975182
# nodes with random walk samples: 9335
# sampled pairs: 26246194
# nodes with random walk samples: 6653
# sampled pairs: 18251020
Generating eval data ....
No. Train: Pos=4830, Neg=4830 
No. Val: Pos=4830, Neg=4830 
No. Test: Pos=14493, Neg=14493
/home/wtx/workspace/python_project/DySAT_pytorch/utils/minibatch.py:111: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at /opt/conda/conda-bld/pytorch_1670525541990/work/torch/csrc/utils/tensor_new.cpp:230.)
  node_2_neg_list = [torch.LongTensor(node) for node in node_2_negative]
Epoch 0  ,  Loss = 27.200, Val AUC 0.930 Test AUC 0.929
val auc 0.864, ap 0.836, recall 0.985, acc 0.705
test auc 0.862, ap 0.834, recall 0.985, acc 0.706
average time 155.08422684669495, memory 31849424896.0
Traceback (most recent call last):
  File "/home/wtx/workspace/python_project/DySAT_pytorch/train.py", line 163, in <module>
    loss = model.get_loss(feed_dict)
  File "/home/wtx/workspace/python_project/DySAT_pytorch/models/model.py", line 101, in get_loss
    final_emb = self.forward(graphs) # [N, T, F]
  File "/home/wtx/workspace/python_project/DySAT_pytorch/models/model.py", line 65, in forward
    temporal_out = self.temporal_attn(structural_outputs_padded)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/wtx/workspace/python_project/DySAT_pytorch/models/layers.py", line 129, in forward
    padding = torch.ones_like(masks) * (-2**32+1)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 356.00 MiB (GPU 0; 44.35 GiB total capacity; 43.39 GiB already allocated; 53.75 MiB free; 43.92 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
