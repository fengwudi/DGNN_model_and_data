Namespace(GPU_ID=3, batch_size=1000, dataset='mooc', early_stop=3, epochs=50, featureless=True, learning_rate=0.0001, neg_sample_size=1, neg_weight=1.0, position_ffn='True', residual=True, spatial_drop=0.1, structural_head_config='16,8,8', structural_layer_config='128', temporal_drop=0.5, temporal_head_config='16', temporal_layer_config='128', test_freq=1, time_steps=-1, val_freq=1, walk_len=20, weight_decay=0.0005, window=-1)
Loaded 26 graphs 
Computing training pairs ...
# nodes with random walk samples: 800
# sampled pairs: 2258030
# nodes with random walk samples: 1610
# sampled pairs: 4556250
# nodes with random walk samples: 1368
# sampled pairs: 3867756
# nodes with random walk samples: 1279
# sampled pairs: 3600550
# nodes with random walk samples: 1140
# sampled pairs: 3205262
# nodes with random walk samples: 1086
# sampled pairs: 3044256
# nodes with random walk samples: 1162
# sampled pairs: 3275490
# nodes with random walk samples: 1481
# sampled pairs: 4211314
# nodes with random walk samples: 1483
# sampled pairs: 4217960
# nodes with random walk samples: 1392
# sampled pairs: 3945714
# nodes with random walk samples: 1246
# sampled pairs: 3532282
# nodes with random walk samples: 1237
# sampled pairs: 3500688
# nodes with random walk samples: 1238
# sampled pairs: 3511984
# nodes with random walk samples: 1253
# sampled pairs: 3564970
# nodes with random walk samples: 1304
# sampled pairs: 3717870
# nodes with random walk samples: 1345
# sampled pairs: 3819634
# nodes with random walk samples: 1184
# sampled pairs: 3367662
# nodes with random walk samples: 1118
# sampled pairs: 3179218
# nodes with random walk samples: 1278
# sampled pairs: 3636710
# nodes with random walk samples: 1259
# sampled pairs: 3594936
# nodes with random walk samples: 1138
# sampled pairs: 3251530
# nodes with random walk samples: 1333
# sampled pairs: 3796994
# nodes with random walk samples: 1073
# sampled pairs: 3056600
# nodes with random walk samples: 987
# sampled pairs: 2814968
# nodes with random walk samples: 1138
# sampled pairs: 3244760
# nodes with random walk samples: 1054
# sampled pairs: 3005770
Generating eval data ....
No. Train: Pos=1878, Neg=1878 
No. Val: Pos=1878, Neg=1878 
No. Test: Pos=5634, Neg=5634
Epoch 0  ,  Loss = nan, Val AUC 0.651 Test AUC 0.648
val auc 0.4159, ap 0.4271, recall 1.0000, acc 0.5000
test auc 0.4279, ap 0.4308, recall 1.0000, acc 0.5000
average time 37.94 s, memory 11578.59 MB
Epoch 1  ,  Loss = nan, Val AUC 0.697 Test AUC 0.692
val auc 0.3534, ap 0.3962, recall 1.0000, acc 0.5000
test auc 0.3635, ap 0.3995, recall 1.0000, acc 0.5000
average time 32.19 s, memory 14000.44 MB
Epoch 2  ,  Loss = nan, Val AUC 0.744 Test AUC 0.738
val auc 0.3005, ap 0.3745, recall 1.0000, acc 0.5000
test auc 0.3087, ap 0.3770, recall 1.0000, acc 0.5000
average time 30.33 s, memory 14807.73 MB
Epoch 3  ,  Loss = nan, Val AUC 0.783 Test AUC 0.777
val auc 0.2578, ap 0.3594, recall 1.0000, acc 0.5000
test auc 0.2643, ap 0.3612, recall 1.0000, acc 0.5000
average time 29.49 s, memory 15211.37 MB
Best Test AUC = 0.648
