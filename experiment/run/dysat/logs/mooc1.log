Namespace(GPU_ID=3, batch_size=512, dataset='mooc', early_stop=3, epochs=50, featureless=True, learning_rate=0.01, neg_sample_size=10, neg_weight=1.0, position_ffn='True', residual=True, spatial_drop=0.1, structural_head_config='16,8,8', structural_layer_config='128', temporal_drop=0.5, temporal_head_config='16', temporal_layer_config='128', test_freq=1, time_steps=-1, val_freq=1, walk_len=20, weight_decay=0.0005, window=-1)
Loaded 26 graphs 
Computing training pairs ...
# nodes with random walk samples: 779
# sampled pairs: 2199924
# nodes with random walk samples: 1600
# sampled pairs: 4528368
# nodes with random walk samples: 1362
# sampled pairs: 3851646
# nodes with random walk samples: 1273
# sampled pairs: 3583784
# nodes with random walk samples: 1137
# sampled pairs: 3198116
# nodes with random walk samples: 1082
# sampled pairs: 3032426
# nodes with random walk samples: 1151
# sampled pairs: 3246636
# nodes with random walk samples: 1470
# sampled pairs: 4181052
# nodes with random walk samples: 1474
# sampled pairs: 4191968
# nodes with random walk samples: 1381
# sampled pairs: 3915016
# nodes with random walk samples: 1239
# sampled pairs: 3513346
# nodes with random walk samples: 1231
# sampled pairs: 3484860
# nodes with random walk samples: 1226
# sampled pairs: 3480462
# nodes with random walk samples: 1238
# sampled pairs: 3526878
# nodes with random walk samples: 1293
# sampled pairs: 3687390
# nodes with random walk samples: 1330
# sampled pairs: 3786202
# nodes with random walk samples: 1176
# sampled pairs: 3344992
# nodes with random walk samples: 1107
# sampled pairs: 3148928
# nodes with random walk samples: 1257
# sampled pairs: 3579332
# nodes with random walk samples: 1244
# sampled pairs: 3553120
# nodes with random walk samples: 1128
# sampled pairs: 3222514
# nodes with random walk samples: 1313
# sampled pairs: 3748464
# nodes with random walk samples: 1058
# sampled pairs: 3017916
# nodes with random walk samples: 973
# sampled pairs: 2776004
# nodes with random walk samples: 1116
# sampled pairs: 3183084
# nodes with random walk samples: 1033
# sampled pairs: 2946692
Generating eval data ....
No. Train: Pos=1877, Neg=1877 
No. Val: Pos=1877, Neg=1877 
No. Test: Pos=5634, Neg=5634
Epoch 0  ,  Loss = 38.672, Val AUC 0.831 Test AUC 0.825
val auc 0.382, ap 0.413, recall 0.583, acc 0.431
test auc 0.3843, ap 0.4138, recall 0.5811, acc 0.4286
average time 78.52 s, memory 11348.19 MB
Epoch 1  ,  Loss = 33.547, Val AUC 0.778 Test AUC 0.770
val auc 0.427, ap 0.434, recall 0.574, acc 0.459
test auc 0.4660, ap 0.4576, recall 0.5735, acc 0.4802
average time 70.31 s, memory 13716.88 MB
Epoch 2  ,  Loss = 32.263, Val AUC 0.744 Test AUC 0.743
val auc 0.436, ap 0.437, recall 0.569, acc 0.467
test auc 0.4473, ap 0.4412, recall 0.5479, acc 0.4690
average time 67.36 s, memory 14506.44 MB
Epoch 3  ,  Loss = 31.150, Val AUC 0.704 Test AUC 0.708
val auc 0.443, ap 0.438, recall 0.566, acc 0.472
test auc 0.4573, ap 0.4392, recall 0.5502, acc 0.4820
average time 66.12 s, memory 14901.22 MB
Best Test AUC = 0.825
