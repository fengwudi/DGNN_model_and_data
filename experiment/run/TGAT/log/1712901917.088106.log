2024-04-12 14:05:17,088 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='wikipedia', drop_out=0.1, gpu=1, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=2, node_dim=100, prefix='wiki-2l', time='time', time_dim=100, uniform=True)
2024-04-12 14:05:17,927 - module - INFO - Aggregation uses attention model
2024-04-12 14:05:17,945 - module - INFO - Using scaled prod attention
2024-04-12 14:05:17,962 - module - INFO - Using scaled prod attention
2024-04-12 14:05:17,962 - module - INFO - Using time encoding
2024-04-12 14:05:19,822 - root - INFO - num of training instances: 81029
2024-04-12 14:05:19,822 - root - INFO - num of batches per epoch: 82
2024-04-12 14:05:19,825 - root - INFO - start 0 epoch
2024-04-12 14:08:36,283 - root - INFO - epoch: 0
2024-04-12 14:08:36,283 - root - INFO - total memory use: 11695.40 MB
2024-04-12 14:08:36,284 - root - INFO - train time: 110.52 s
2024-04-12 14:08:36,284 - root - INFO - Epoch mean loss: 1.0155688349793597
2024-04-12 14:08:36,284 - root - INFO - train acc: 0.7263, val acc: 0.7424, new node val acc: 0.7562
2024-04-12 14:08:36,284 - root - INFO - train auc: 0.8192, val auc: 0.8342, new node val auc: 0.8457
2024-04-12 14:08:36,284 - root - INFO - train ap: 0.8196, val ap: 0.8480, new node val ap: 0.8609
2024-04-12 14:08:36,284 - root - INFO - train recall: 0.7343, val recall: 0.7185, new node val recall: 0.7261
2024-04-12 14:08:36,939 - root - INFO - start 1 epoch
2024-04-12 14:11:56,984 - root - INFO - epoch: 1
2024-04-12 14:11:56,985 - root - INFO - total memory use: 23390.81 MB
2024-04-12 14:11:56,985 - root - INFO - train time: 114.99 s
2024-04-12 14:11:56,985 - root - INFO - Epoch mean loss: 0.810602110333559
2024-04-12 14:11:56,985 - root - INFO - train acc: 0.8039, val acc: 0.7794, new node val acc: 0.7873
2024-04-12 14:11:56,985 - root - INFO - train auc: 0.8945, val auc: 0.8711, new node val auc: 0.8826
2024-04-12 14:11:56,985 - root - INFO - train ap: 0.8941, val ap: 0.8774, new node val ap: 0.8914
2024-04-12 14:11:56,985 - root - INFO - train recall: 0.8330, val recall: 0.8425, new node val recall: 0.8441
2024-04-12 14:11:57,600 - root - INFO - start 2 epoch
2024-04-12 14:16:58,759 - root - INFO - epoch: 2
2024-04-12 14:16:58,760 - root - INFO - total memory use: 35086.21 MB
2024-04-12 14:16:58,760 - root - INFO - train time: 110.39 s
2024-04-12 14:16:58,760 - root - INFO - Epoch mean loss: 0.7418630123138428
2024-04-12 14:16:58,760 - root - INFO - train acc: 0.8284, val acc: 0.8206, new node val acc: 0.8228
2024-04-12 14:16:58,760 - root - INFO - train auc: 0.9138, val auc: 0.9034, new node val auc: 0.9060
2024-04-12 14:16:58,760 - root - INFO - train ap: 0.9129, val ap: 0.9070, new node val ap: 0.9110
2024-04-12 14:16:58,760 - root - INFO - train recall: 0.8628, val recall: 0.8312, new node val recall: 0.8352
2024-04-12 14:16:59,640 - root - INFO - start 3 epoch
2024-04-12 14:23:10,043 - root - INFO - epoch: 3
2024-04-12 14:23:10,043 - root - INFO - total memory use: 46781.62 MB
2024-04-12 14:23:10,044 - root - INFO - train time: 191.45 s
2024-04-12 14:23:10,044 - root - INFO - Epoch mean loss: 0.6742118880516146
2024-04-12 14:23:10,044 - root - INFO - train acc: 0.8477, val acc: 0.8298, new node val acc: 0.8349
2024-04-12 14:23:10,044 - root - INFO - train auc: 0.9305, val auc: 0.9150, new node val auc: 0.9179
2024-04-12 14:23:10,044 - root - INFO - train ap: 0.9294, val ap: 0.9176, new node val ap: 0.9226
2024-04-12 14:23:10,044 - root - INFO - train recall: 0.8749, val recall: 0.8823, new node val recall: 0.8795
2024-04-12 14:23:10,955 - root - INFO - start 4 epoch
2024-04-12 14:29:50,822 - root - INFO - epoch: 4
2024-04-12 14:29:50,822 - root - INFO - total memory use: 58477.02 MB
2024-04-12 14:29:50,823 - root - INFO - train time: 195.54 s
2024-04-12 14:29:50,823 - root - INFO - Epoch mean loss: 0.6439222991466522
2024-04-12 14:29:50,823 - root - INFO - train acc: 0.8576, val acc: 0.8423, new node val acc: 0.8421
2024-04-12 14:29:50,823 - root - INFO - train auc: 0.9368, val auc: 0.9227, new node val auc: 0.9231
2024-04-12 14:29:50,823 - root - INFO - train ap: 0.9363, val ap: 0.9255, new node val ap: 0.9258
2024-04-12 14:29:50,823 - root - INFO - train recall: 0.8825, val recall: 0.8697, new node val recall: 0.8672
2024-04-12 14:29:51,698 - root - INFO - start 5 epoch
2024-04-12 14:35:42,247 - root - INFO - epoch: 5
2024-04-12 14:35:42,248 - root - INFO - total memory use: 70172.43 MB
2024-04-12 14:35:42,248 - root - INFO - train time: 183.04 s
2024-04-12 14:35:42,248 - root - INFO - Epoch mean loss: 0.6115141467350286
2024-04-12 14:35:42,248 - root - INFO - train acc: 0.8656, val acc: 0.8549, new node val acc: 0.8531
2024-04-12 14:35:42,248 - root - INFO - train auc: 0.9439, val auc: 0.9308, new node val auc: 0.9299
2024-04-12 14:35:42,248 - root - INFO - train ap: 0.9442, val ap: 0.9333, new node val ap: 0.9338
2024-04-12 14:35:42,248 - root - INFO - train recall: 0.8876, val recall: 0.8789, new node val recall: 0.8796
2024-04-12 14:35:43,133 - root - INFO - start 6 epoch
2024-04-12 14:41:57,889 - root - INFO - epoch: 6
2024-04-12 14:41:57,890 - root - INFO - total memory use: 81867.83 MB
2024-04-12 14:41:57,890 - root - INFO - train time: 180.33 s
2024-04-12 14:41:57,890 - root - INFO - Epoch mean loss: 0.5807071451733752
2024-04-12 14:41:57,890 - root - INFO - train acc: 0.8750, val acc: 0.8612, new node val acc: 0.8568
2024-04-12 14:41:57,890 - root - INFO - train auc: 0.9493, val auc: 0.9377, new node val auc: 0.9358
2024-04-12 14:41:57,890 - root - INFO - train ap: 0.9496, val ap: 0.9404, new node val ap: 0.9393
2024-04-12 14:41:57,890 - root - INFO - train recall: 0.8934, val recall: 0.8742, new node val recall: 0.8664
2024-04-12 14:41:58,798 - root - INFO - start 7 epoch
2024-04-12 14:47:50,530 - root - INFO - epoch: 7
2024-04-12 14:47:50,531 - root - INFO - total memory use: 93563.24 MB
2024-04-12 14:47:50,531 - root - INFO - train time: 183.60 s
2024-04-12 14:47:50,531 - root - INFO - Epoch mean loss: 0.5586809832148436
2024-04-12 14:47:50,531 - root - INFO - train acc: 0.8799, val acc: 0.8628, new node val acc: 0.8595
2024-04-12 14:47:50,531 - root - INFO - train auc: 0.9530, val auc: 0.9393, new node val auc: 0.9373
2024-04-12 14:47:50,531 - root - INFO - train ap: 0.9532, val ap: 0.9419, new node val ap: 0.9406
2024-04-12 14:47:50,531 - root - INFO - train recall: 0.8968, val recall: 0.8601, new node val recall: 0.8521
2024-04-12 14:47:51,347 - root - INFO - start 8 epoch
2024-04-12 14:53:54,092 - root - INFO - epoch: 8
2024-04-12 14:53:54,093 - root - INFO - total memory use: 105258.64 MB
2024-04-12 14:53:54,093 - root - INFO - train time: 174.72 s
2024-04-12 14:53:54,093 - root - INFO - Epoch mean loss: 0.5500204152450329
2024-04-12 14:53:54,093 - root - INFO - train acc: 0.8809, val acc: 0.8691, new node val acc: 0.8666
2024-04-12 14:53:54,093 - root - INFO - train auc: 0.9545, val auc: 0.9436, new node val auc: 0.9433
2024-04-12 14:53:54,093 - root - INFO - train ap: 0.9552, val ap: 0.9457, new node val ap: 0.9463
2024-04-12 14:53:54,093 - root - INFO - train recall: 0.8972, val recall: 0.8795, new node val recall: 0.8796
2024-04-12 14:53:54,716 - root - INFO - start 9 epoch
2024-04-12 15:00:01,499 - root - INFO - epoch: 9
2024-04-12 15:00:01,499 - root - INFO - total memory use: 116954.05 MB
2024-04-12 15:00:01,499 - root - INFO - train time: 183.81 s
2024-04-12 15:00:01,499 - root - INFO - Epoch mean loss: 0.5374791458612536
2024-04-12 15:00:01,500 - root - INFO - train acc: 0.8856, val acc: 0.8710, new node val acc: 0.8662
2024-04-12 15:00:01,500 - root - INFO - train auc: 0.9566, val auc: 0.9434, new node val auc: 0.9413
2024-04-12 15:00:01,500 - root - INFO - train ap: 0.9571, val ap: 0.9458, new node val ap: 0.9444
2024-04-12 15:00:01,500 - root - INFO - train recall: 0.8993, val recall: 0.8951, new node val recall: 0.8884
2024-04-12 15:00:02,412 - root - INFO - start 10 epoch
2024-04-12 15:05:58,812 - root - INFO - epoch: 10
2024-04-12 15:05:58,813 - root - INFO - total memory use: 128649.45 MB
2024-04-12 15:05:58,813 - root - INFO - train time: 189.13 s
2024-04-12 15:05:58,813 - root - INFO - Epoch mean loss: 0.5213560251201071
2024-04-12 15:05:58,813 - root - INFO - train acc: 0.8880, val acc: 0.8709, new node val acc: 0.8697
2024-04-12 15:05:58,813 - root - INFO - train auc: 0.9592, val auc: 0.9450, new node val auc: 0.9445
2024-04-12 15:05:58,813 - root - INFO - train ap: 0.9602, val ap: 0.9469, new node val ap: 0.9479
2024-04-12 15:05:58,813 - root - INFO - train recall: 0.9011, val recall: 0.8810, new node val recall: 0.8744
2024-04-12 15:05:59,842 - root - INFO - start 11 epoch
2024-04-12 15:12:31,149 - root - INFO - epoch: 11
2024-04-12 15:12:31,149 - root - INFO - total memory use: 140344.85 MB
2024-04-12 15:12:31,150 - root - INFO - train time: 193.36 s
2024-04-12 15:12:31,150 - root - INFO - Epoch mean loss: 0.5124661831594095
2024-04-12 15:12:31,150 - root - INFO - train acc: 0.8901, val acc: 0.8706, new node val acc: 0.8660
2024-04-12 15:12:31,150 - root - INFO - train auc: 0.9605, val auc: 0.9460, new node val auc: 0.9441
2024-04-12 15:12:31,150 - root - INFO - train ap: 0.9612, val ap: 0.9481, new node val ap: 0.9476
2024-04-12 15:12:31,150 - root - INFO - train recall: 0.9017, val recall: 0.8901, new node val recall: 0.8851
2024-04-12 15:12:31,958 - root - INFO - start 12 epoch
2024-04-12 15:17:59,279 - root - INFO - epoch: 12
2024-04-12 15:17:59,279 - root - INFO - total memory use: 152040.26 MB
2024-04-12 15:17:59,279 - root - INFO - train time: 188.56 s
2024-04-12 15:17:59,279 - root - INFO - Epoch mean loss: 0.5086853289749564
2024-04-12 15:17:59,279 - root - INFO - train acc: 0.8902, val acc: 0.8725, new node val acc: 0.8672
2024-04-12 15:17:59,279 - root - INFO - train auc: 0.9611, val auc: 0.9461, new node val auc: 0.9441
2024-04-12 15:17:59,279 - root - INFO - train ap: 0.9623, val ap: 0.9485, new node val ap: 0.9478
2024-04-12 15:17:59,279 - root - INFO - train recall: 0.9031, val recall: 0.8698, new node val recall: 0.8599
2024-04-12 15:17:59,931 - root - INFO - start 13 epoch
2024-04-12 15:23:41,679 - root - INFO - epoch: 13
2024-04-12 15:23:41,679 - root - INFO - total memory use: 163735.66 MB
2024-04-12 15:23:41,679 - root - INFO - train time: 204.89 s
2024-04-12 15:23:41,680 - root - INFO - Epoch mean loss: 0.5050144820678525
2024-04-12 15:23:41,680 - root - INFO - train acc: 0.8922, val acc: 0.8755, new node val acc: 0.8712
2024-04-12 15:23:41,680 - root - INFO - train auc: 0.9618, val auc: 0.9474, new node val auc: 0.9476
2024-04-12 15:23:41,680 - root - INFO - train ap: 0.9623, val ap: 0.9495, new node val ap: 0.9507
2024-04-12 15:23:41,681 - root - INFO - train recall: 0.9037, val recall: 0.8624, new node val recall: 0.8538
2024-04-12 15:23:42,622 - root - INFO - start 14 epoch
2024-04-12 15:29:26,129 - root - INFO - epoch: 14
2024-04-12 15:29:26,129 - root - INFO - total memory use: 175431.07 MB
2024-04-12 15:29:26,129 - root - INFO - train time: 209.23 s
2024-04-12 15:29:26,129 - root - INFO - Epoch mean loss: 0.5011714173526298
2024-04-12 15:29:26,129 - root - INFO - train acc: 0.8931, val acc: 0.8761, new node val acc: 0.8726
2024-04-12 15:29:26,129 - root - INFO - train auc: 0.9620, val auc: 0.9488, new node val auc: 0.9469
2024-04-12 15:29:26,129 - root - INFO - train ap: 0.9625, val ap: 0.9509, new node val ap: 0.9491
2024-04-12 15:29:26,129 - root - INFO - train recall: 0.9035, val recall: 0.8981, new node val recall: 0.8915
2024-04-12 15:29:27,117 - root - INFO - start 15 epoch
2024-04-12 15:35:05,659 - root - INFO - epoch: 15
2024-04-12 15:35:05,659 - root - INFO - total memory use: 187126.47 MB
2024-04-12 15:35:05,659 - root - INFO - train time: 209.73 s
2024-04-12 15:35:05,659 - root - INFO - Epoch mean loss: 0.49363901447959063
2024-04-12 15:35:05,659 - root - INFO - train acc: 0.8943, val acc: 0.8772, new node val acc: 0.8710
2024-04-12 15:35:05,659 - root - INFO - train auc: 0.9631, val auc: 0.9505, new node val auc: 0.9466
2024-04-12 15:35:05,659 - root - INFO - train ap: 0.9642, val ap: 0.9530, new node val ap: 0.9499
2024-04-12 15:35:05,659 - root - INFO - train recall: 0.9068, val recall: 0.8637, new node val recall: 0.8554
2024-04-12 15:35:06,592 - root - INFO - start 16 epoch
2024-04-12 15:40:50,153 - root - INFO - epoch: 16
2024-04-12 15:40:50,153 - root - INFO - total memory use: 198821.88 MB
2024-04-12 15:40:50,153 - root - INFO - train time: 209.79 s
2024-04-12 15:40:50,153 - root - INFO - Epoch mean loss: 0.4980991013893267
2024-04-12 15:40:50,153 - root - INFO - train acc: 0.8935, val acc: 0.8775, new node val acc: 0.8750
2024-04-12 15:40:50,153 - root - INFO - train auc: 0.9625, val auc: 0.9505, new node val auc: 0.9486
2024-04-12 15:40:50,153 - root - INFO - train ap: 0.9630, val ap: 0.9530, new node val ap: 0.9512
2024-04-12 15:40:50,154 - root - INFO - train recall: 0.9026, val recall: 0.8902, new node val recall: 0.8876
2024-04-12 15:40:51,081 - root - INFO - start 17 epoch
2024-04-12 15:46:37,922 - root - INFO - epoch: 17
2024-04-12 15:46:37,922 - root - INFO - total memory use: 210517.28 MB
2024-04-12 15:46:37,922 - root - INFO - train time: 212.50 s
2024-04-12 15:46:37,923 - root - INFO - Epoch mean loss: 0.4823229374682031
2024-04-12 15:46:37,923 - root - INFO - train acc: 0.8971, val acc: 0.8792, new node val acc: 0.8745
2024-04-12 15:46:37,923 - root - INFO - train auc: 0.9649, val auc: 0.9514, new node val auc: 0.9488
2024-04-12 15:46:37,923 - root - INFO - train ap: 0.9656, val ap: 0.9531, new node val ap: 0.9511
2024-04-12 15:46:37,924 - root - INFO - train recall: 0.9067, val recall: 0.8776, new node val recall: 0.8671
2024-04-12 15:46:38,884 - root - INFO - start 18 epoch
2024-04-12 15:52:30,500 - root - INFO - epoch: 18
2024-04-12 15:52:30,500 - root - INFO - total memory use: 222212.69 MB
2024-04-12 15:52:30,500 - root - INFO - train time: 213.56 s
2024-04-12 15:52:30,500 - root - INFO - Epoch mean loss: 0.4750374515609043
2024-04-12 15:52:30,501 - root - INFO - train acc: 0.8980, val acc: 0.8799, new node val acc: 0.8731
2024-04-12 15:52:30,501 - root - INFO - train auc: 0.9660, val auc: 0.9510, new node val auc: 0.9474
2024-04-12 15:52:30,501 - root - INFO - train ap: 0.9669, val ap: 0.9532, new node val ap: 0.9497
2024-04-12 15:52:30,501 - root - INFO - train recall: 0.9062, val recall: 0.8876, new node val recall: 0.8787
2024-04-12 15:52:30,501 - root - INFO - No improvment over 3 epochs, stop training
2024-04-12 15:52:30,501 - root - INFO - Loading the best model at epoch 16
2024-04-12 15:52:30,691 - root - INFO - Loaded the best model at epoch 16 for inference
2024-04-12 15:52:30,691 - root - INFO - early stop total time: 3459.15 s
2024-04-12 15:52:30,691 - root - INFO - early stop average time: 182.06 s
2024-04-12 15:52:30,691 - root - INFO - average memory use: 11695.40 MB
2024-04-12 15:54:29,250 - root - INFO - Test statistics: Old nodes -- acc: 0.8632, auc: 0.9387, ap: 0.9418, recall: 0.8799
2024-04-12 15:54:29,250 - root - INFO - Test statistics: New nodes -- acc: 0.8404, auc: 0.9260, ap: 0.9314, recall: 0.8737
2024-04-12 15:54:29,250 - root - INFO - total time: 3459.15 s
2024-04-12 15:54:29,250 - root - INFO - complete average time: 182.06 s
2024-04-12 15:54:29,250 - root - INFO - average memory use: 11695.40 MB
2024-04-12 15:54:29,250 - root - INFO - Saving TGAN model
2024-04-12 15:54:30,191 - root - INFO - TGAN models saved
