2024-03-21 22:22:56,657 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='wikipedia', drop_out=0.1, gpu=2, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='wiki', time='time', time_dim=100, uniform=True)
2024-03-21 22:22:57,381 - module - INFO - Aggregation uses attention model
2024-03-21 22:22:57,394 - module - INFO - Using scaled prod attention
2024-03-21 22:22:57,394 - module - INFO - Using time encoding
2024-03-21 22:22:58,440 - root - INFO - num of training instances: 81029
2024-03-21 22:22:58,440 - root - INFO - num of batches per epoch: 82
2024-03-21 22:22:58,443 - root - INFO - start 0 epoch
2024-03-21 22:23:11,961 - root - INFO - epoch: 0:
2024-03-21 22:23:11,961 - root - INFO - Epoch mean loss: 1.1407848749218918
2024-03-21 22:23:11,961 - root - INFO - train acc: 0.6673432055749128, val acc: 0.6213832487309644, new node val acc: 0.6418952618453866
2024-03-21 22:23:11,961 - root - INFO - train auc: 0.750514386261822, val auc: 0.6938134517766498, new node val auc: 0.7220144084233859
2024-03-21 22:23:11,961 - root - INFO - train ap: 0.7694810360442095, val ap: 0.7397531577227175, new node val ap: 0.7702027753392063
2024-03-21 22:23:12,571 - root - INFO - start 1 epoch
2024-03-21 22:23:25,412 - root - INFO - epoch: 1:
2024-03-21 22:23:25,412 - root - INFO - Epoch mean loss: 1.0338526033773654
2024-03-21 22:23:25,412 - root - INFO - train acc: 0.7191411149825785, val acc: 0.6828257191201355, new node val acc: 0.6979634247714048
2024-03-21 22:23:25,412 - root - INFO - train auc: 0.8076178613738177, val auc: 0.7632296954314721, new node val auc: 0.7820906068162926
2024-03-21 22:23:25,412 - root - INFO - train ap: 0.8201786411177745, val ap: 0.7938851696070425, new node val ap: 0.8122927939417857
2024-03-21 22:23:26,018 - root - INFO - start 2 epoch
2024-03-21 22:23:38,826 - root - INFO - epoch: 2:
2024-03-21 22:23:38,826 - root - INFO - Epoch mean loss: 0.9789905460869394
2024-03-21 22:23:38,826 - root - INFO - train acc: 0.7455217770034843, val acc: 0.6890016920473774, new node val acc: 0.6993765586034912
2024-03-21 22:23:38,826 - root - INFO - train auc: 0.8343580102040816, val auc: 0.7772567681895093, new node val auc: 0.7907259628706013
2024-03-21 22:23:38,826 - root - INFO - train ap: 0.8430807878705628, val ap: 0.8036959126235799, new node val ap: 0.8198287066601222
2024-03-21 22:23:39,430 - root - INFO - start 3 epoch
2024-03-21 22:23:52,239 - root - INFO - epoch: 3:
2024-03-21 22:23:52,239 - root - INFO - Epoch mean loss: 0.9437511519687932
2024-03-21 22:23:52,239 - root - INFO - train acc: 0.7578728222996516, val acc: 0.7101522842639594, new node val acc: 0.71571072319202
2024-03-21 22:23:52,239 - root - INFO - train auc: 0.8492198236684917, val auc: 0.8000274957698815, new node val auc: 0.8091715156553061
2024-03-21 22:23:52,239 - root - INFO - train ap: 0.8567168068725186, val ap: 0.8222516524716312, new node val ap: 0.834599694782378
2024-03-21 22:23:52,841 - root - INFO - start 4 epoch
2024-03-21 22:24:05,660 - root - INFO - epoch: 4:
2024-03-21 22:24:05,660 - root - INFO - Epoch mean loss: 0.9259514139919747
2024-03-21 22:24:05,660 - root - INFO - train acc: 0.7671968641114982, val acc: 0.7233925549915398, new node val acc: 0.7302992518703243
2024-03-21 22:24:05,660 - root - INFO - train auc: 0.8565774953957191, val auc: 0.8094331641285955, new node val auc: 0.8199653643668607
2024-03-21 22:24:05,660 - root - INFO - train ap: 0.8631169567325602, val ap: 0.8300088509803997, new node val ap: 0.8418746230373698
2024-03-21 22:24:06,265 - root - INFO - start 5 epoch
2024-03-21 22:24:19,060 - root - INFO - epoch: 5:
2024-03-21 22:24:19,060 - root - INFO - Epoch mean loss: 0.9031013366652698
2024-03-21 22:24:19,060 - root - INFO - train acc: 0.7738214285714287, val acc: 0.7297377326565143, new node val acc: 0.7348295926849542
2024-03-21 22:24:19,060 - root - INFO - train auc: 0.8648869879293182, val auc: 0.819016497461929, new node val auc: 0.8246882793017456
2024-03-21 22:24:19,060 - root - INFO - train ap: 0.8705817895150572, val ap: 0.8384437270433452, new node val ap: 0.847056060504133
2024-03-21 22:24:19,664 - root - INFO - start 6 epoch
2024-03-21 22:24:32,482 - root - INFO - epoch: 6:
2024-03-21 22:24:32,482 - root - INFO - Epoch mean loss: 0.8891838563651573
2024-03-21 22:24:32,482 - root - INFO - train acc: 0.7803597560975609, val acc: 0.734010152284264, new node val acc: 0.7386118038237738
2024-03-21 22:24:32,482 - root - INFO - train auc: 0.8697371772025885, val auc: 0.8207853919909757, new node val auc: 0.8285009697977279
2024-03-21 22:24:32,482 - root - INFO - train ap: 0.874702021552208, val ap: 0.8386055064539453, new node val ap: 0.848946556932423
2024-03-21 22:24:33,084 - root - INFO - start 7 epoch
2024-03-21 22:24:45,903 - root - INFO - epoch: 7:
2024-03-21 22:24:45,903 - root - INFO - Epoch mean loss: 0.8760522240545692
2024-03-21 22:24:45,903 - root - INFO - train acc: 0.7833850174216028, val acc: 0.7411802030456852, new node val acc: 0.7497921862011636
2024-03-21 22:24:45,903 - root - INFO - train auc: 0.8746866407416625, val auc: 0.8288113367174281, new node val auc: 0.838438625658077
2024-03-21 22:24:45,903 - root - INFO - train ap: 0.8797145146094388, val ap: 0.8456596353445309, new node val ap: 0.8574546322254116
2024-03-21 22:24:46,508 - root - INFO - start 8 epoch
2024-03-21 22:24:59,356 - root - INFO - epoch: 8:
2024-03-21 22:24:59,357 - root - INFO - Epoch mean loss: 0.87320724275054
2024-03-21 22:24:59,357 - root - INFO - train acc: 0.7856228222996516, val acc: 0.7445008460236887, new node val acc: 0.7463424771404821
2024-03-21 22:24:59,357 - root - INFO - train auc: 0.8757597809855651, val auc: 0.8312648054145516, new node val auc: 0.836828761429759
2024-03-21 22:24:59,357 - root - INFO - train ap: 0.8801991230662818, val ap: 0.8467132823109005, new node val ap: 0.8564911669354488
2024-03-21 22:24:59,742 - root - INFO - start 9 epoch
2024-03-21 22:25:12,591 - root - INFO - epoch: 9:
2024-03-21 22:25:12,591 - root - INFO - Epoch mean loss: 0.8663364350795746
2024-03-21 22:25:12,591 - root - INFO - train acc: 0.7896054006968642, val acc: 0.7444162436548222, new node val acc: 0.7492934330839569
2024-03-21 22:25:12,591 - root - INFO - train auc: 0.87775393728223, val auc: 0.832794698251551, new node val auc: 0.8425796619562206
2024-03-21 22:25:12,591 - root - INFO - train ap: 0.8822057928858479, val ap: 0.849526852732262, new node val ap: 0.8616655393897479
2024-03-21 22:25:12,973 - root - INFO - start 10 epoch
2024-03-21 22:25:25,791 - root - INFO - epoch: 10:
2024-03-21 22:25:25,791 - root - INFO - Epoch mean loss: 0.8551854796525908
2024-03-21 22:25:25,791 - root - INFO - train acc: 0.7915662020905924, val acc: 0.7519670050761421, new node val acc: 0.7564422277639237
2024-03-21 22:25:25,791 - root - INFO - train auc: 0.8807341738427079, val auc: 0.8397941342357587, new node val auc: 0.8448586866167913
2024-03-21 22:25:25,791 - root - INFO - train ap: 0.8854321828225332, val ap: 0.8546819772403647, new node val ap: 0.8618413757460242
2024-03-21 22:25:26,172 - root - INFO - start 11 epoch
2024-03-21 22:25:38,977 - root - INFO - epoch: 11:
2024-03-21 22:25:38,977 - root - INFO - Epoch mean loss: 0.8374522277494756
2024-03-21 22:25:38,977 - root - INFO - train acc: 0.7970165505226481, val acc: 0.7553510998307953, new node val acc: 0.7671238570241065
2024-03-21 22:25:38,977 - root - INFO - train auc: 0.8865964291936287, val auc: 0.842452763677383, new node val auc: 0.8536810750900526
2024-03-21 22:25:38,977 - root - INFO - train ap: 0.8912285182750335, val ap: 0.8565996490857847, new node val ap: 0.8699438648358905
2024-03-21 22:25:39,359 - root - INFO - start 12 epoch
2024-03-21 22:25:52,117 - root - INFO - epoch: 12:
2024-03-21 22:25:52,117 - root - INFO - Epoch mean loss: 0.8339465740250378
2024-03-21 22:25:52,117 - root - INFO - train acc: 0.7995078397212543, val acc: 0.7542089678510997, new node val acc: 0.7601828761429759
2024-03-21 22:25:52,117 - root - INFO - train auc: 0.8886556763315081, val auc: 0.8419521996615904, new node val auc: 0.8486492103075646
2024-03-21 22:25:52,117 - root - INFO - train ap: 0.8920451602748626, val ap: 0.8562672671199582, new node val ap: 0.8653607010980541
2024-03-21 22:25:52,497 - root - INFO - start 13 epoch
2024-03-21 22:26:05,284 - root - INFO - epoch: 13:
2024-03-21 22:26:05,284 - root - INFO - Epoch mean loss: 0.8289608519251753
2024-03-21 22:26:05,284 - root - INFO - train acc: 0.8001829268292683, val acc: 0.7549069373942472, new node val acc: 0.7664588528678304
2024-03-21 22:26:05,284 - root - INFO - train auc: 0.8894078154554504, val auc: 0.8412648054145517, new node val auc: 0.850628983097811
2024-03-21 22:26:05,284 - root - INFO - train ap: 0.893263916051777, val ap: 0.8561485074280417, new node val ap: 0.8668660957907837
2024-03-21 22:26:05,666 - root - INFO - start 14 epoch
2024-03-21 22:26:18,471 - root - INFO - epoch: 14:
2024-03-21 22:26:18,471 - root - INFO - Epoch mean loss: 0.8231819046706688
2024-03-21 22:26:18,471 - root - INFO - train acc: 0.8032952961672474, val acc: 0.7513959390862944, new node val acc: 0.7576475477971736
2024-03-21 22:26:18,471 - root - INFO - train auc: 0.8914815643354903, val auc: 0.8367110829103216, new node val auc: 0.8441576614020505
2024-03-21 22:26:18,472 - root - INFO - train ap: 0.8957027255630354, val ap: 0.850472493225443, new node val ap: 0.859842438070277
2024-03-21 22:26:18,472 - root - INFO - No improvment over 3 epochs, stop training
2024-03-21 22:26:18,472 - root - INFO - Loading the best model at epoch 12
2024-03-21 22:26:18,575 - root - INFO - Loaded the best model at epoch 12 for inference
2024-03-21 22:26:26,050 - root - INFO - Test statistics: Old nodes -- acc: 0.7364424703891708, auc: 0.8212760857304005, ap: 0.836444987997211
2024-03-21 22:26:26,050 - root - INFO - Test statistics: New nodes -- acc: 0.729594446474242, auc: 0.8143494499248976, ap: 0.8309449624576717
2024-03-21 22:26:26,050 - root - INFO - Saving TGAN model
2024-03-21 22:26:26,597 - root - INFO - TGAN models saved
