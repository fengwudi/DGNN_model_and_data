2024-03-26 16:30:52,617 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='reddit', drop_out=0.1, gpu=2, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='reddit', time='time', time_dim=100, uniform=True)
2024-03-26 16:30:57,539 - module - INFO - Aggregation uses attention model
2024-03-26 16:30:57,554 - module - INFO - Using scaled prod attention
2024-03-26 16:30:57,555 - module - INFO - Using time encoding
2024-03-26 16:30:59,445 - root - INFO - num of training instances: 389989
2024-03-26 16:30:59,445 - root - INFO - num of batches per epoch: 390
2024-03-26 16:30:59,457 - root - INFO - start 0 epoch
2024-03-26 16:31:58,747 - root - INFO - epoch: 0
2024-03-26 16:31:58,747 - root - INFO - total memory use: 1510.92 MB
2024-03-26 16:31:58,747 - root - INFO - train time: 25.60 s
2024-03-26 16:31:58,747 - root - INFO - Epoch mean loss: 0.8277815670539171
2024-03-26 16:31:58,747 - root - INFO - train acc: 0.8067, val acc: 0.8398, new node val acc: 0.8161
2024-03-26 16:31:58,747 - root - INFO - train auc: 0.8895, val auc: 0.9244, new node val auc: 0.9006
2024-03-26 16:31:58,747 - root - INFO - train ap: 0.8871, val ap: 0.9269, new node val ap: 0.9003
2024-03-26 16:31:58,747 - root - INFO - train recall: 0.8249, val recall: 0.8955, new node val recall: 0.8720
2024-03-26 16:32:01,960 - root - INFO - start 1 epoch
2024-03-26 16:33:02,121 - root - INFO - epoch: 1
2024-03-26 16:33:02,121 - root - INFO - total memory use: 3021.85 MB
2024-03-26 16:33:02,121 - root - INFO - train time: 25.87 s
2024-03-26 16:33:02,121 - root - INFO - Epoch mean loss: 0.6624271403520535
2024-03-26 16:33:02,121 - root - INFO - train acc: 0.8557, val acc: 0.8523, new node val acc: 0.8263
2024-03-26 16:33:02,121 - root - INFO - train auc: 0.9326, val auc: 0.9344, new node val auc: 0.9097
2024-03-26 16:33:02,122 - root - INFO - train ap: 0.9336, val ap: 0.9368, new node val ap: 0.9097
2024-03-26 16:33:02,122 - root - INFO - train recall: 0.8665, val recall: 0.9016, new node val recall: 0.8730
2024-03-26 16:33:05,366 - root - INFO - start 2 epoch
2024-03-26 16:34:05,720 - root - INFO - epoch: 2
2024-03-26 16:34:05,721 - root - INFO - total memory use: 4532.77 MB
2024-03-26 16:34:05,721 - root - INFO - train time: 26.40 s
2024-03-26 16:34:05,721 - root - INFO - Epoch mean loss: 0.6330970764160156
2024-03-26 16:34:05,721 - root - INFO - train acc: 0.8630, val acc: 0.8619, new node val acc: 0.8315
2024-03-26 16:34:05,721 - root - INFO - train auc: 0.9392, val auc: 0.9399, new node val auc: 0.9147
2024-03-26 16:34:05,721 - root - INFO - train ap: 0.9405, val ap: 0.9423, new node val ap: 0.9162
2024-03-26 16:34:05,721 - root - INFO - train recall: 0.8720, val recall: 0.8979, new node val recall: 0.8624
2024-03-26 16:34:10,158 - root - INFO - start 3 epoch
2024-03-26 16:35:09,356 - root - INFO - epoch: 3
2024-03-26 16:35:09,356 - root - INFO - total memory use: 6043.70 MB
2024-03-26 16:35:09,356 - root - INFO - train time: 25.54 s
2024-03-26 16:35:09,356 - root - INFO - Epoch mean loss: 0.6111489062125867
2024-03-26 16:35:09,356 - root - INFO - train acc: 0.8689, val acc: 0.8688, new node val acc: 0.8379
2024-03-26 16:35:09,356 - root - INFO - train auc: 0.9436, val auc: 0.9448, new node val auc: 0.9216
2024-03-26 16:35:09,356 - root - INFO - train ap: 0.9448, val ap: 0.9471, new node val ap: 0.9242
2024-03-26 16:35:09,357 - root - INFO - train recall: 0.8749, val recall: 0.9005, new node val recall: 0.8652
2024-03-26 16:35:12,758 - root - INFO - start 4 epoch
2024-03-26 16:36:11,795 - root - INFO - epoch: 4
2024-03-26 16:36:11,795 - root - INFO - total memory use: 7554.62 MB
2024-03-26 16:36:11,795 - root - INFO - train time: 25.24 s
2024-03-26 16:36:11,795 - root - INFO - Epoch mean loss: 0.5950730115939409
2024-03-26 16:36:11,795 - root - INFO - train acc: 0.8729, val acc: 0.8710, new node val acc: 0.8432
2024-03-26 16:36:11,795 - root - INFO - train auc: 0.9464, val auc: 0.9467, new node val auc: 0.9223
2024-03-26 16:36:11,795 - root - INFO - train ap: 0.9478, val ap: 0.9491, new node val ap: 0.9237
2024-03-26 16:36:11,796 - root - INFO - train recall: 0.8776, val recall: 0.9012, new node val recall: 0.8662
2024-03-26 16:36:15,005 - root - INFO - start 5 epoch
2024-03-26 16:37:13,942 - root - INFO - epoch: 5
2024-03-26 16:37:13,943 - root - INFO - total memory use: 9065.55 MB
2024-03-26 16:37:13,943 - root - INFO - train time: 25.28 s
2024-03-26 16:37:13,943 - root - INFO - Epoch mean loss: 0.582943068865018
2024-03-26 16:37:13,943 - root - INFO - train acc: 0.8758, val acc: 0.8720, new node val acc: 0.8438
2024-03-26 16:37:13,943 - root - INFO - train auc: 0.9485, val auc: 0.9491, new node val auc: 0.9255
2024-03-26 16:37:13,943 - root - INFO - train ap: 0.9498, val ap: 0.9515, new node val ap: 0.9277
2024-03-26 16:37:13,943 - root - INFO - train recall: 0.8788, val recall: 0.9113, new node val recall: 0.8786
2024-03-26 16:37:17,556 - root - INFO - start 6 epoch
2024-03-26 16:38:16,663 - root - INFO - epoch: 6
2024-03-26 16:38:16,663 - root - INFO - total memory use: 10576.47 MB
2024-03-26 16:38:16,663 - root - INFO - train time: 25.57 s
2024-03-26 16:38:16,663 - root - INFO - Epoch mean loss: 0.5714942544698716
2024-03-26 16:38:16,663 - root - INFO - train acc: 0.8789, val acc: 0.8772, new node val acc: 0.8507
2024-03-26 16:38:16,663 - root - INFO - train auc: 0.9505, val auc: 0.9502, new node val auc: 0.9281
2024-03-26 16:38:16,663 - root - INFO - train ap: 0.9519, val ap: 0.9521, new node val ap: 0.9296
2024-03-26 16:38:16,663 - root - INFO - train recall: 0.8808, val recall: 0.9039, new node val recall: 0.8665
2024-03-26 16:38:19,435 - root - INFO - start 7 epoch
2024-03-26 16:39:17,929 - root - INFO - epoch: 7
2024-03-26 16:39:17,929 - root - INFO - total memory use: 12087.40 MB
2024-03-26 16:39:17,929 - root - INFO - train time: 24.91 s
2024-03-26 16:39:17,929 - root - INFO - Epoch mean loss: 0.5636067490547131
2024-03-26 16:39:17,929 - root - INFO - train acc: 0.8811, val acc: 0.8793, new node val acc: 0.8469
2024-03-26 16:39:17,929 - root - INFO - train auc: 0.9517, val auc: 0.9520, new node val auc: 0.9275
2024-03-26 16:39:17,929 - root - INFO - train ap: 0.9532, val ap: 0.9543, new node val ap: 0.9296
2024-03-26 16:39:17,929 - root - INFO - train recall: 0.8824, val recall: 0.9088, new node val recall: 0.8675
2024-03-26 16:39:21,136 - root - INFO - start 8 epoch
2024-03-26 16:40:19,998 - root - INFO - epoch: 8
2024-03-26 16:40:19,999 - root - INFO - total memory use: 13598.32 MB
2024-03-26 16:40:19,999 - root - INFO - train time: 25.21 s
2024-03-26 16:40:19,999 - root - INFO - Epoch mean loss: 0.5553768035693046
2024-03-26 16:40:19,999 - root - INFO - train acc: 0.8829, val acc: 0.8794, new node val acc: 0.8502
2024-03-26 16:40:19,999 - root - INFO - train auc: 0.9530, val auc: 0.9526, new node val auc: 0.9292
2024-03-26 16:40:19,999 - root - INFO - train ap: 0.9545, val ap: 0.9548, new node val ap: 0.9308
2024-03-26 16:40:19,999 - root - INFO - train recall: 0.8835, val recall: 0.9113, new node val recall: 0.8742
2024-03-26 16:40:23,172 - root - INFO - start 9 epoch
2024-03-26 16:41:22,003 - root - INFO - epoch: 9
2024-03-26 16:41:22,004 - root - INFO - total memory use: 15109.25 MB
2024-03-26 16:41:22,004 - root - INFO - train time: 25.39 s
2024-03-26 16:41:22,004 - root - INFO - Epoch mean loss: 0.5483677381888414
2024-03-26 16:41:22,004 - root - INFO - train acc: 0.8844, val acc: 0.8807, new node val acc: 0.8514
2024-03-26 16:41:22,004 - root - INFO - train auc: 0.9540, val auc: 0.9543, new node val auc: 0.9305
2024-03-26 16:41:22,004 - root - INFO - train ap: 0.9555, val ap: 0.9567, new node val ap: 0.9321
2024-03-26 16:41:22,004 - root - INFO - train recall: 0.8845, val recall: 0.9157, new node val recall: 0.8817
2024-03-26 16:41:25,179 - root - INFO - start 10 epoch
2024-03-26 16:42:24,065 - root - INFO - epoch: 10
2024-03-26 16:42:24,065 - root - INFO - total memory use: 16620.17 MB
2024-03-26 16:42:24,065 - root - INFO - train time: 25.27 s
2024-03-26 16:42:24,065 - root - INFO - Epoch mean loss: 0.5437849516287828
2024-03-26 16:42:24,065 - root - INFO - train acc: 0.8855, val acc: 0.8827, new node val acc: 0.8552
2024-03-26 16:42:24,065 - root - INFO - train auc: 0.9548, val auc: 0.9548, new node val auc: 0.9343
2024-03-26 16:42:24,065 - root - INFO - train ap: 0.9562, val ap: 0.9568, new node val ap: 0.9366
2024-03-26 16:42:24,065 - root - INFO - train recall: 0.8858, val recall: 0.9148, new node val recall: 0.8799
2024-03-26 16:42:27,241 - root - INFO - start 11 epoch
2024-03-26 16:43:26,107 - root - INFO - epoch: 11
2024-03-26 16:43:26,107 - root - INFO - total memory use: 18131.10 MB
2024-03-26 16:43:26,107 - root - INFO - train time: 25.33 s
2024-03-26 16:43:26,107 - root - INFO - Epoch mean loss: 0.5389602924768742
2024-03-26 16:43:26,107 - root - INFO - train acc: 0.8867, val acc: 0.8840, new node val acc: 0.8543
2024-03-26 16:43:26,107 - root - INFO - train auc: 0.9555, val auc: 0.9559, new node val auc: 0.9330
2024-03-26 16:43:26,107 - root - INFO - train ap: 0.9569, val ap: 0.9581, new node val ap: 0.9354
2024-03-26 16:43:26,107 - root - INFO - train recall: 0.8860, val recall: 0.9148, new node val recall: 0.8777
2024-03-26 16:43:28,855 - root - INFO - start 12 epoch
2024-03-26 16:44:29,384 - root - INFO - epoch: 12
2024-03-26 16:44:29,384 - root - INFO - total memory use: 19642.02 MB
2024-03-26 16:44:29,384 - root - INFO - train time: 25.19 s
2024-03-26 16:44:29,384 - root - INFO - Epoch mean loss: 0.5343415416968175
2024-03-26 16:44:29,385 - root - INFO - train acc: 0.8881, val acc: 0.8867, new node val acc: 0.8574
2024-03-26 16:44:29,385 - root - INFO - train auc: 0.9563, val auc: 0.9568, new node val auc: 0.9333
2024-03-26 16:44:29,385 - root - INFO - train ap: 0.9578, val ap: 0.9590, new node val ap: 0.9346
2024-03-26 16:44:29,385 - root - INFO - train recall: 0.8874, val recall: 0.9093, new node val recall: 0.8684
2024-03-26 16:44:32,699 - root - INFO - start 13 epoch
2024-03-26 16:45:38,054 - root - INFO - epoch: 13
2024-03-26 16:45:38,054 - root - INFO - total memory use: 21152.95 MB
2024-03-26 16:45:38,054 - root - INFO - train time: 30.10 s
2024-03-26 16:45:38,054 - root - INFO - Epoch mean loss: 0.5297198284894992
2024-03-26 16:45:38,055 - root - INFO - train acc: 0.8888, val acc: 0.8865, new node val acc: 0.8548
2024-03-26 16:45:38,055 - root - INFO - train auc: 0.9570, val auc: 0.9569, new node val auc: 0.9334
2024-03-26 16:45:38,055 - root - INFO - train ap: 0.9584, val ap: 0.9593, new node val ap: 0.9361
2024-03-26 16:45:38,055 - root - INFO - train recall: 0.8881, val recall: 0.9048, new node val recall: 0.8606
2024-03-26 16:45:41,321 - root - INFO - start 14 epoch
2024-03-26 16:46:41,989 - root - INFO - epoch: 14
2024-03-26 16:46:41,989 - root - INFO - total memory use: 22663.87 MB
2024-03-26 16:46:41,989 - root - INFO - train time: 26.92 s
2024-03-26 16:46:41,989 - root - INFO - Epoch mean loss: 0.5249641174689318
2024-03-26 16:46:41,989 - root - INFO - train acc: 0.8901, val acc: 0.8881, new node val acc: 0.8573
2024-03-26 16:46:41,989 - root - INFO - train auc: 0.9578, val auc: 0.9580, new node val auc: 0.9346
2024-03-26 16:46:41,989 - root - INFO - train ap: 0.9592, val ap: 0.9602, new node val ap: 0.9364
2024-03-26 16:46:41,989 - root - INFO - train recall: 0.8891, val recall: 0.9144, new node val recall: 0.8747
2024-03-26 16:46:44,438 - root - INFO - start 15 epoch
2024-03-26 16:47:43,402 - root - INFO - epoch: 15
2024-03-26 16:47:43,402 - root - INFO - total memory use: 24174.80 MB
2024-03-26 16:47:43,402 - root - INFO - train time: 25.34 s
2024-03-26 16:47:43,402 - root - INFO - Epoch mean loss: 0.5209190609363409
2024-03-26 16:47:43,402 - root - INFO - train acc: 0.8908, val acc: 0.8894, new node val acc: 0.8593
2024-03-26 16:47:43,403 - root - INFO - train auc: 0.9584, val auc: 0.9581, new node val auc: 0.9358
2024-03-26 16:47:43,403 - root - INFO - train ap: 0.9597, val ap: 0.9603, new node val ap: 0.9374
2024-03-26 16:47:43,403 - root - INFO - train recall: 0.8893, val recall: 0.9098, new node val recall: 0.8658
2024-03-26 16:47:45,834 - root - INFO - start 16 epoch
2024-03-26 16:48:44,774 - root - INFO - epoch: 16
2024-03-26 16:48:44,774 - root - INFO - total memory use: 25685.72 MB
2024-03-26 16:48:44,774 - root - INFO - train time: 25.19 s
2024-03-26 16:48:44,774 - root - INFO - Epoch mean loss: 0.5170947220080938
2024-03-26 16:48:44,774 - root - INFO - train acc: 0.8916, val acc: 0.8898, new node val acc: 0.8591
2024-03-26 16:48:44,774 - root - INFO - train auc: 0.9590, val auc: 0.9590, new node val auc: 0.9365
2024-03-26 16:48:44,774 - root - INFO - train ap: 0.9605, val ap: 0.9613, new node val ap: 0.9389
2024-03-26 16:48:44,774 - root - INFO - train recall: 0.8906, val recall: 0.9071, new node val recall: 0.8670
2024-03-26 16:48:47,217 - root - INFO - start 17 epoch
2024-03-26 16:49:46,160 - root - INFO - epoch: 17
2024-03-26 16:49:46,160 - root - INFO - total memory use: 27196.65 MB
2024-03-26 16:49:46,160 - root - INFO - train time: 25.19 s
2024-03-26 16:49:46,160 - root - INFO - Epoch mean loss: 0.5158726434677076
2024-03-26 16:49:46,160 - root - INFO - train acc: 0.8924, val acc: 0.8894, new node val acc: 0.8600
2024-03-26 16:49:46,160 - root - INFO - train auc: 0.9592, val auc: 0.9590, new node val auc: 0.9379
2024-03-26 16:49:46,160 - root - INFO - train ap: 0.9606, val ap: 0.9612, new node val ap: 0.9404
2024-03-26 16:49:46,160 - root - INFO - train recall: 0.8905, val recall: 0.9148, new node val recall: 0.8768
2024-03-26 16:49:48,568 - root - INFO - start 18 epoch
2024-03-26 16:50:52,096 - root - INFO - epoch: 18
2024-03-26 16:50:52,096 - root - INFO - total memory use: 28707.57 MB
2024-03-26 16:50:52,096 - root - INFO - train time: 29.31 s
2024-03-26 16:50:52,096 - root - INFO - Epoch mean loss: 0.5123361342992538
2024-03-26 16:50:52,096 - root - INFO - train acc: 0.8930, val acc: 0.8916, new node val acc: 0.8556
2024-03-26 16:50:52,096 - root - INFO - train auc: 0.9597, val auc: 0.9595, new node val auc: 0.9344
2024-03-26 16:50:52,096 - root - INFO - train ap: 0.9611, val ap: 0.9615, new node val ap: 0.9367
2024-03-26 16:50:52,096 - root - INFO - train recall: 0.8916, val recall: 0.9129, new node val recall: 0.8655
2024-03-26 16:50:54,495 - root - INFO - start 19 epoch
2024-03-26 16:51:52,912 - root - INFO - epoch: 19
2024-03-26 16:51:52,912 - root - INFO - total memory use: 30218.50 MB
2024-03-26 16:51:52,912 - root - INFO - train time: 24.93 s
2024-03-26 16:51:52,913 - root - INFO - Epoch mean loss: 0.5103133687606225
2024-03-26 16:51:52,913 - root - INFO - train acc: 0.8933, val acc: 0.8909, new node val acc: 0.8613
2024-03-26 16:51:52,913 - root - INFO - train auc: 0.9600, val auc: 0.9591, new node val auc: 0.9383
2024-03-26 16:51:52,913 - root - INFO - train ap: 0.9614, val ap: 0.9612, new node val ap: 0.9411
2024-03-26 16:51:52,913 - root - INFO - train recall: 0.8920, val recall: 0.9105, new node val recall: 0.8671
2024-03-26 16:51:52,913 - root - INFO - No improvment over 3 epochs, stop training
2024-03-26 16:51:52,913 - root - INFO - Loading the best model at epoch 17
2024-03-26 16:51:53,397 - root - INFO - Loaded the best model at epoch 17 for inference
2024-03-26 16:51:53,397 - root - INFO - early stop total time: 517.78 s
2024-03-26 16:51:53,397 - root - INFO - early stop average time: 25.89 s
2024-03-26 16:51:53,397 - root - INFO - average memory use: 1510.92 MB
2024-03-26 16:52:23,450 - root - INFO - Test statistics: Old nodes -- acc: 0.8877, auc: 0.9585, ap: 0.9610, recall: 0.9151
2024-03-26 16:52:23,450 - root - INFO - Test statistics: New nodes -- acc: 0.8437, auc: 0.9250, ap: 0.9269, recall: 0.8852
2024-03-26 16:52:23,450 - root - INFO - total time: 517.78 s
2024-03-26 16:52:23,450 - root - INFO - complete average time: 25.89 s
2024-03-26 16:52:23,450 - root - INFO - average memory use: 1510.92 MB
2024-03-26 16:52:23,450 - root - INFO - Saving TGAN model
2024-03-26 16:52:26,616 - root - INFO - TGAN models saved
