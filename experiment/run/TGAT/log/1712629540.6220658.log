2024-04-09 10:25:40,622 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=2000, data='Flights', drop_out=0.1, gpu=3, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='flight2000', time='time', time_dim=100, uniform=True)
2024-04-09 10:25:55,677 - module - INFO - Aggregation uses attention model
2024-04-09 10:25:55,693 - module - INFO - Using scaled prod attention
2024-04-09 10:25:55,693 - module - INFO - Using time encoding
2024-04-09 10:25:58,205 - root - INFO - num of training instances: 1102788
2024-04-09 10:25:58,205 - root - INFO - num of batches per epoch: 552
2024-04-09 10:25:58,257 - root - INFO - start 0 epoch
2024-04-09 10:30:17,547 - root - INFO - epoch: 0
2024-04-09 10:30:17,547 - root - INFO - total memory use: 3762.44 MB
2024-04-09 10:30:17,547 - root - INFO - train time: 94.17 s
2024-04-09 10:30:17,547 - root - INFO - Epoch mean loss: 1.1003699294034985
2024-04-09 10:30:17,547 - root - INFO - train acc: 0.7117, val acc: 0.6309, new node val acc: 0.6332
2024-04-09 10:30:17,548 - root - INFO - train auc: 0.7656, val auc: 0.7026, new node val auc: 0.7041
2024-04-09 10:30:17,548 - root - INFO - train ap: 0.7131, val ap: 0.6799, new node val ap: 0.6827
2024-04-09 10:30:17,548 - root - INFO - train recall: 0.8208, val recall: 0.5932, new node val recall: 0.5959
2024-04-09 10:30:25,171 - root - INFO - start 1 epoch
2024-04-09 10:34:38,973 - root - INFO - epoch: 1
2024-04-09 10:34:38,973 - root - INFO - total memory use: 7524.87 MB
2024-04-09 10:34:38,973 - root - INFO - train time: 93.85 s
2024-04-09 10:34:38,973 - root - INFO - Epoch mean loss: 1.0836147486731627
2024-04-09 10:34:38,973 - root - INFO - train acc: 0.7192, val acc: 0.6227, new node val acc: 0.6234
2024-04-09 10:34:38,973 - root - INFO - train auc: 0.7728, val auc: 0.7037, new node val auc: 0.7026
2024-04-09 10:34:38,973 - root - INFO - train ap: 0.7213, val ap: 0.6812, new node val ap: 0.6810
2024-04-09 10:34:38,973 - root - INFO - train recall: 0.8300, val recall: 0.5273, new node val recall: 0.5321
2024-04-09 10:34:46,644 - root - INFO - start 2 epoch
2024-04-09 10:38:54,759 - root - INFO - epoch: 2
2024-04-09 10:38:54,759 - root - INFO - total memory use: 11287.31 MB
2024-04-09 10:38:54,759 - root - INFO - train time: 85.72 s
2024-04-09 10:38:54,759 - root - INFO - Epoch mean loss: 1.07673484346141
2024-04-09 10:38:54,759 - root - INFO - train acc: 0.7231, val acc: 0.6239, new node val acc: 0.6247
2024-04-09 10:38:54,759 - root - INFO - train auc: 0.7779, val auc: 0.7035, new node val auc: 0.7034
2024-04-09 10:38:54,759 - root - INFO - train ap: 0.7259, val ap: 0.6803, new node val ap: 0.6806
2024-04-09 10:38:54,759 - root - INFO - train recall: 0.8331, val recall: 0.5382, new node val recall: 0.5424
2024-04-09 10:39:01,726 - root - INFO - start 3 epoch
2024-04-09 10:43:17,613 - root - INFO - epoch: 3
2024-04-09 10:43:17,613 - root - INFO - total memory use: 15049.75 MB
2024-04-09 10:43:17,613 - root - INFO - train time: 89.63 s
2024-04-09 10:43:17,613 - root - INFO - Epoch mean loss: 1.0766490078058795
2024-04-09 10:43:17,613 - root - INFO - train acc: 0.7221, val acc: 0.6063, new node val acc: 0.6076
2024-04-09 10:43:17,613 - root - INFO - train auc: 0.7777, val auc: 0.7031, new node val auc: 0.7032
2024-04-09 10:43:17,613 - root - INFO - train ap: 0.7259, val ap: 0.6800, new node val ap: 0.6813
2024-04-09 10:43:17,613 - root - INFO - train recall: 0.8324, val recall: 0.4293, new node val recall: 0.4328
2024-04-09 10:43:25,644 - root - INFO - start 4 epoch
2024-04-09 10:47:17,238 - root - INFO - epoch: 4
2024-04-09 10:47:17,238 - root - INFO - total memory use: 18812.19 MB
2024-04-09 10:47:17,238 - root - INFO - train time: 87.33 s
2024-04-09 10:47:17,238 - root - INFO - Epoch mean loss: 1.076131772087968
2024-04-09 10:47:17,238 - root - INFO - train acc: 0.7222, val acc: 0.6304, new node val acc: 0.6319
2024-04-09 10:47:17,239 - root - INFO - train auc: 0.7773, val auc: 0.7039, new node val auc: 0.7032
2024-04-09 10:47:17,239 - root - INFO - train ap: 0.7253, val ap: 0.6801, new node val ap: 0.6813
2024-04-09 10:47:17,239 - root - INFO - train recall: 0.8314, val recall: 0.5859, new node val recall: 0.5906
2024-04-09 10:47:17,239 - root - INFO - No improvment over 3 epochs, stop training
2024-04-09 10:47:17,239 - root - INFO - Loading the best model at epoch 2
2024-04-09 10:47:18,876 - root - INFO - Loaded the best model at epoch 2 for inference
2024-04-09 10:47:18,876 - root - INFO - early stop total time: 450.70 s
2024-04-09 10:47:18,876 - root - INFO - early stop average time: 90.14 s
2024-04-09 10:47:18,876 - root - INFO - average memory use: 3762.44 MB
2024-04-09 10:49:12,622 - root - INFO - Test statistics: Old nodes -- acc: 0.6225, auc: 0.6996, ap: 0.6794, recall: 0.5275
2024-04-09 10:49:12,622 - root - INFO - Test statistics: New nodes -- acc: 0.5547, auc: 0.5828, ap: 0.5920, recall: 0.5304
2024-04-09 10:49:12,622 - root - INFO - total time: 450.70 s
2024-04-09 10:49:12,622 - root - INFO - complete average time: 90.14 s
2024-04-09 10:49:12,622 - root - INFO - average memory use: 3762.44 MB
2024-04-09 10:49:12,622 - root - INFO - Saving TGAN model
2024-04-09 10:49:19,989 - root - INFO - TGAN models saved
