2024-03-26 16:30:52,630 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='wikipedia', drop_out=0.1, gpu=0, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='wiki', time='time', time_dim=100, uniform=True)
2024-03-26 16:30:53,486 - module - INFO - Aggregation uses attention model
2024-03-26 16:30:53,502 - module - INFO - Using scaled prod attention
2024-03-26 16:30:53,503 - module - INFO - Using time encoding
2024-03-26 16:30:55,584 - root - INFO - num of training instances: 81029
2024-03-26 16:30:55,584 - root - INFO - num of batches per epoch: 82
2024-03-26 16:30:55,587 - root - INFO - start 0 epoch
2024-03-26 16:31:10,620 - root - INFO - epoch: 0
2024-03-26 16:31:10,621 - root - INFO - total memory use: 797.62 MB
2024-03-26 16:31:10,621 - root - INFO - train time: 5.51 s
2024-03-26 16:31:10,621 - root - INFO - Epoch mean loss: 1.1132097324220145
2024-03-26 16:31:10,621 - root - INFO - train acc: 0.6797, val acc: 0.6405, new node val acc: 0.6662
2024-03-26 16:31:10,621 - root - INFO - train auc: 0.7636, val auc: 0.7119, new node val auc: 0.7436
2024-03-26 16:31:10,621 - root - INFO - train ap: 0.7831, val ap: 0.7535, new node val ap: 0.7853
2024-03-26 16:31:10,621 - root - INFO - train recall: 0.6467, val recall: 0.5957, new node val recall: 0.6303
2024-03-26 16:31:11,439 - root - INFO - start 1 epoch
2024-03-26 16:31:25,920 - root - INFO - epoch: 1
2024-03-26 16:31:25,920 - root - INFO - total memory use: 1595.23 MB
2024-03-26 16:31:25,920 - root - INFO - train time: 4.95 s
2024-03-26 16:31:25,920 - root - INFO - Epoch mean loss: 1.0243691663916519
2024-03-26 16:31:25,920 - root - INFO - train acc: 0.7225, val acc: 0.6891, new node val acc: 0.6977
2024-03-26 16:31:25,920 - root - INFO - train auc: 0.8126, val auc: 0.7774, new node val auc: 0.7910
2024-03-26 16:31:25,920 - root - INFO - train ap: 0.8258, val ap: 0.8057, new node val ap: 0.8216
2024-03-26 16:31:25,920 - root - INFO - train recall: 0.7072, val recall: 0.7540, new node val recall: 0.7672
2024-03-26 16:31:26,723 - root - INFO - start 2 epoch
2024-03-26 16:31:41,153 - root - INFO - epoch: 2
2024-03-26 16:31:41,153 - root - INFO - total memory use: 2392.85 MB
2024-03-26 16:31:41,153 - root - INFO - train time: 4.94 s
2024-03-26 16:31:41,153 - root - INFO - Epoch mean loss: 0.9591160663744298
2024-03-26 16:31:41,154 - root - INFO - train acc: 0.7505, val acc: 0.7087, new node val acc: 0.7201
2024-03-26 16:31:41,154 - root - INFO - train auc: 0.8411, val auc: 0.7976, new node val auc: 0.8135
2024-03-26 16:31:41,154 - root - INFO - train ap: 0.8503, val ap: 0.8210, new node val ap: 0.8388
2024-03-26 16:31:41,154 - root - INFO - train recall: 0.7516, val recall: 0.7657, new node val recall: 0.7791
2024-03-26 16:31:41,966 - root - INFO - start 3 epoch
2024-03-26 16:31:56,390 - root - INFO - epoch: 3
2024-03-26 16:31:56,390 - root - INFO - total memory use: 3190.46 MB
2024-03-26 16:31:56,391 - root - INFO - train time: 4.89 s
2024-03-26 16:31:56,391 - root - INFO - Epoch mean loss: 0.9297214899121261
2024-03-26 16:31:56,391 - root - INFO - train acc: 0.7657, val acc: 0.7158, new node val acc: 0.7283
2024-03-26 16:31:56,391 - root - INFO - train auc: 0.8547, val auc: 0.8041, new node val auc: 0.8211
2024-03-26 16:31:56,391 - root - INFO - train ap: 0.8621, val ap: 0.8245, new node val ap: 0.8417
2024-03-26 16:31:56,391 - root - INFO - train recall: 0.7709, val recall: 0.7696, new node val recall: 0.7919
2024-03-26 16:31:57,199 - root - INFO - start 4 epoch
2024-03-26 16:32:11,657 - root - INFO - epoch: 4
2024-03-26 16:32:11,657 - root - INFO - total memory use: 3988.08 MB
2024-03-26 16:32:11,657 - root - INFO - train time: 4.97 s
2024-03-26 16:32:11,658 - root - INFO - Epoch mean loss: 0.911341864888261
2024-03-26 16:32:11,658 - root - INFO - train acc: 0.7716, val acc: 0.7181, new node val acc: 0.7295
2024-03-26 16:32:11,658 - root - INFO - train auc: 0.8613, val auc: 0.8101, new node val auc: 0.8251
2024-03-26 16:32:11,658 - root - INFO - train ap: 0.8672, val ap: 0.8304, new node val ap: 0.8460
2024-03-26 16:32:11,658 - root - INFO - train recall: 0.7764, val recall: 0.7894, new node val recall: 0.8031
2024-03-26 16:32:12,422 - root - INFO - start 5 epoch
2024-03-26 16:32:26,863 - root - INFO - epoch: 5
2024-03-26 16:32:26,863 - root - INFO - total memory use: 4785.70 MB
2024-03-26 16:32:26,863 - root - INFO - train time: 4.95 s
2024-03-26 16:32:26,863 - root - INFO - Epoch mean loss: 0.9089548573261355
2024-03-26 16:32:26,863 - root - INFO - train acc: 0.7745, val acc: 0.7227, new node val acc: 0.7350
2024-03-26 16:32:26,863 - root - INFO - train auc: 0.8631, val auc: 0.8148, new node val auc: 0.8292
2024-03-26 16:32:26,863 - root - INFO - train ap: 0.8682, val ap: 0.8335, new node val ap: 0.8492
2024-03-26 16:32:26,863 - root - INFO - train recall: 0.7813, val recall: 0.7947, new node val recall: 0.8098
2024-03-26 16:32:27,615 - root - INFO - start 6 epoch
2024-03-26 16:32:42,106 - root - INFO - epoch: 6
2024-03-26 16:32:42,106 - root - INFO - total memory use: 5583.31 MB
2024-03-26 16:32:42,106 - root - INFO - train time: 4.90 s
2024-03-26 16:32:42,106 - root - INFO - Epoch mean loss: 0.893429820857397
2024-03-26 16:32:42,107 - root - INFO - train acc: 0.7785, val acc: 0.7326, new node val acc: 0.7399
2024-03-26 16:32:42,107 - root - INFO - train auc: 0.8675, val auc: 0.8235, new node val auc: 0.8318
2024-03-26 16:32:42,107 - root - INFO - train ap: 0.8729, val ap: 0.8419, new node val ap: 0.8518
2024-03-26 16:32:42,107 - root - INFO - train recall: 0.7873, val recall: 0.7822, new node val recall: 0.7923
2024-03-26 16:32:42,832 - root - INFO - start 7 epoch
2024-03-26 16:32:57,364 - root - INFO - epoch: 7
2024-03-26 16:32:57,364 - root - INFO - total memory use: 6380.93 MB
2024-03-26 16:32:57,364 - root - INFO - train time: 4.93 s
2024-03-26 16:32:57,364 - root - INFO - Epoch mean loss: 0.8704652444618505
2024-03-26 16:32:57,364 - root - INFO - train acc: 0.7861, val acc: 0.7370, new node val acc: 0.7406
2024-03-26 16:32:57,364 - root - INFO - train auc: 0.8763, val auc: 0.8262, new node val auc: 0.8331
2024-03-26 16:32:57,364 - root - INFO - train ap: 0.8811, val ap: 0.8442, new node val ap: 0.8530
2024-03-26 16:32:57,364 - root - INFO - train recall: 0.7925, val recall: 0.7813, new node val recall: 0.7919
2024-03-26 16:32:58,116 - root - INFO - start 8 epoch
2024-03-26 16:33:12,626 - root - INFO - epoch: 8
2024-03-26 16:33:12,627 - root - INFO - total memory use: 7178.55 MB
2024-03-26 16:33:12,627 - root - INFO - train time: 4.96 s
2024-03-26 16:33:12,627 - root - INFO - Epoch mean loss: 0.8485354163297792
2024-03-26 16:33:12,627 - root - INFO - train acc: 0.7931, val acc: 0.7427, new node val acc: 0.7510
2024-03-26 16:33:12,627 - root - INFO - train auc: 0.8828, val auc: 0.8313, new node val auc: 0.8413
2024-03-26 16:33:12,627 - root - INFO - train ap: 0.8877, val ap: 0.8490, new node val ap: 0.8605
2024-03-26 16:33:12,627 - root - INFO - train recall: 0.7974, val recall: 0.7771, new node val recall: 0.7841
2024-03-26 16:33:13,416 - root - INFO - start 9 epoch
2024-03-26 16:33:27,918 - root - INFO - epoch: 9
2024-03-26 16:33:27,918 - root - INFO - total memory use: 7976.16 MB
2024-03-26 16:33:27,918 - root - INFO - train time: 4.91 s
2024-03-26 16:33:27,918 - root - INFO - Epoch mean loss: 0.8556553118112611
2024-03-26 16:33:27,918 - root - INFO - train acc: 0.7920, val acc: 0.7460, new node val acc: 0.7470
2024-03-26 16:33:27,918 - root - INFO - train auc: 0.8807, val auc: 0.8353, new node val auc: 0.8395
2024-03-26 16:33:27,918 - root - INFO - train ap: 0.8853, val ap: 0.8522, new node val ap: 0.8583
2024-03-26 16:33:27,918 - root - INFO - train recall: 0.7963, val recall: 0.7885, new node val recall: 0.7939
2024-03-26 16:33:28,699 - root - INFO - start 10 epoch
2024-03-26 16:33:43,080 - root - INFO - epoch: 10
2024-03-26 16:33:43,081 - root - INFO - total memory use: 8773.78 MB
2024-03-26 16:33:43,081 - root - INFO - train time: 4.92 s
2024-03-26 16:33:43,081 - root - INFO - Epoch mean loss: 0.8457324105065044
2024-03-26 16:33:43,081 - root - INFO - train acc: 0.7953, val acc: 0.7504, new node val acc: 0.7568
2024-03-26 16:33:43,081 - root - INFO - train auc: 0.8842, val auc: 0.8374, new node val auc: 0.8460
2024-03-26 16:33:43,081 - root - INFO - train ap: 0.8888, val ap: 0.8533, new node val ap: 0.8651
2024-03-26 16:33:43,081 - root - INFO - train recall: 0.8022, val recall: 0.7822, new node val recall: 0.7881
2024-03-26 16:33:43,868 - root - INFO - start 11 epoch
2024-03-26 16:33:58,269 - root - INFO - epoch: 11
2024-03-26 16:33:58,269 - root - INFO - total memory use: 9571.39 MB
2024-03-26 16:33:58,269 - root - INFO - train time: 4.92 s
2024-03-26 16:33:58,269 - root - INFO - Epoch mean loss: 0.8438851397211958
2024-03-26 16:33:58,270 - root - INFO - train acc: 0.7965, val acc: 0.7451, new node val acc: 0.7510
2024-03-26 16:33:58,270 - root - INFO - train auc: 0.8843, val auc: 0.8334, new node val auc: 0.8433
2024-03-26 16:33:58,270 - root - INFO - train ap: 0.8887, val ap: 0.8477, new node val ap: 0.8606
2024-03-26 16:33:58,270 - root - INFO - train recall: 0.8026, val recall: 0.7776, new node val recall: 0.7909
2024-03-26 16:33:59,045 - root - INFO - start 12 epoch
2024-03-26 16:34:13,422 - root - INFO - epoch: 12
2024-03-26 16:34:13,422 - root - INFO - total memory use: 10369.01 MB
2024-03-26 16:34:13,422 - root - INFO - train time: 4.89 s
2024-03-26 16:34:13,422 - root - INFO - Epoch mean loss: 0.8446739962915095
2024-03-26 16:34:13,422 - root - INFO - train acc: 0.7942, val acc: 0.7529, new node val acc: 0.7578
2024-03-26 16:34:13,422 - root - INFO - train auc: 0.8835, val auc: 0.8405, new node val auc: 0.8453
2024-03-26 16:34:13,422 - root - INFO - train ap: 0.8879, val ap: 0.8543, new node val ap: 0.8623
2024-03-26 16:34:13,422 - root - INFO - train recall: 0.8011, val recall: 0.7609, new node val recall: 0.7685
2024-03-26 16:34:14,192 - root - INFO - start 13 epoch
2024-03-26 16:34:28,615 - root - INFO - epoch: 13
2024-03-26 16:34:28,615 - root - INFO - total memory use: 11166.63 MB
2024-03-26 16:34:28,615 - root - INFO - train time: 4.92 s
2024-03-26 16:34:28,615 - root - INFO - Epoch mean loss: 0.8299959331023984
2024-03-26 16:34:28,616 - root - INFO - train acc: 0.7983, val acc: 0.7545, new node val acc: 0.7619
2024-03-26 16:34:28,616 - root - INFO - train auc: 0.8885, val auc: 0.8408, new node val auc: 0.8515
2024-03-26 16:34:28,616 - root - INFO - train ap: 0.8937, val ap: 0.8565, new node val ap: 0.8678
2024-03-26 16:34:28,616 - root - INFO - train recall: 0.8031, val recall: 0.7668, new node val recall: 0.7796
2024-03-26 16:34:29,393 - root - INFO - start 14 epoch
2024-03-26 16:34:43,733 - root - INFO - epoch: 14
2024-03-26 16:34:43,733 - root - INFO - total memory use: 11964.24 MB
2024-03-26 16:34:43,733 - root - INFO - train time: 4.93 s
2024-03-26 16:34:43,733 - root - INFO - Epoch mean loss: 0.8268271837292648
2024-03-26 16:34:43,733 - root - INFO - train acc: 0.8008, val acc: 0.7503, new node val acc: 0.7566
2024-03-26 16:34:43,733 - root - INFO - train auc: 0.8897, val auc: 0.8416, new node val auc: 0.8450
2024-03-26 16:34:43,733 - root - INFO - train ap: 0.8936, val ap: 0.8555, new node val ap: 0.8607
2024-03-26 16:34:43,733 - root - INFO - train recall: 0.8070, val recall: 0.7918, new node val recall: 0.8047
2024-03-26 16:34:44,307 - root - INFO - start 15 epoch
2024-03-26 16:34:58,646 - root - INFO - epoch: 15
2024-03-26 16:34:58,646 - root - INFO - total memory use: 12761.86 MB
2024-03-26 16:34:58,646 - root - INFO - train time: 4.88 s
2024-03-26 16:34:58,646 - root - INFO - Epoch mean loss: 0.8347432024595214
2024-03-26 16:34:58,646 - root - INFO - train acc: 0.7989, val acc: 0.7516, new node val acc: 0.7603
2024-03-26 16:34:58,646 - root - INFO - train auc: 0.8874, val auc: 0.8398, new node val auc: 0.8470
2024-03-26 16:34:58,646 - root - INFO - train ap: 0.8920, val ap: 0.8541, new node val ap: 0.8630
2024-03-26 16:34:58,646 - root - INFO - train recall: 0.8065, val recall: 0.7712, new node val recall: 0.7801
2024-03-26 16:34:59,223 - root - INFO - start 16 epoch
2024-03-26 16:35:13,634 - root - INFO - epoch: 16
2024-03-26 16:35:13,635 - root - INFO - total memory use: 13559.47 MB
2024-03-26 16:35:13,635 - root - INFO - train time: 4.92 s
2024-03-26 16:35:13,635 - root - INFO - Epoch mean loss: 0.8226691455375857
2024-03-26 16:35:13,635 - root - INFO - train acc: 0.8020, val acc: 0.7546, new node val acc: 0.7552
2024-03-26 16:35:13,635 - root - INFO - train auc: 0.8904, val auc: 0.8408, new node val auc: 0.8455
2024-03-26 16:35:13,635 - root - INFO - train ap: 0.8954, val ap: 0.8552, new node val ap: 0.8635
2024-03-26 16:35:13,635 - root - INFO - train recall: 0.8070, val recall: 0.7681, new node val recall: 0.7727
2024-03-26 16:35:13,635 - root - INFO - No improvment over 3 epochs, stop training
2024-03-26 16:35:13,635 - root - INFO - Loading the best model at epoch 14
2024-03-26 16:35:13,755 - root - INFO - Loaded the best model at epoch 14 for inference
2024-03-26 16:35:13,755 - root - INFO - early stop total time: 84.31 s
2024-03-26 16:35:13,755 - root - INFO - early stop average time: 4.96 s
2024-03-26 16:35:13,755 - root - INFO - average memory use: 797.62 MB
2024-03-26 16:35:22,382 - root - INFO - Test statistics: Old nodes -- acc: 0.7351, auc: 0.8202, ap: 0.8339, recall: 0.7838
2024-03-26 16:35:22,382 - root - INFO - Test statistics: New nodes -- acc: 0.7261, auc: 0.8140, ap: 0.8319, recall: 0.7849
2024-03-26 16:35:22,382 - root - INFO - total time: 84.31 s
2024-03-26 16:35:22,382 - root - INFO - complete average time: 4.96 s
2024-03-26 16:35:22,382 - root - INFO - average memory use: 797.62 MB
2024-03-26 16:35:22,382 - root - INFO - Saving TGAN model
2024-03-26 16:35:23,162 - root - INFO - TGAN models saved
