2024-04-09 10:25:23,595 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=100, data='wikipedia', drop_out=0.1, gpu=0, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='wiki100', time='time', time_dim=100, uniform=True)
2024-04-09 10:25:24,487 - module - INFO - Aggregation uses attention model
2024-04-09 10:25:24,503 - module - INFO - Using scaled prod attention
2024-04-09 10:25:24,503 - module - INFO - Using time encoding
2024-04-09 10:25:27,389 - root - INFO - num of training instances: 81029
2024-04-09 10:25:27,389 - root - INFO - num of batches per epoch: 811
2024-04-09 10:25:27,391 - root - INFO - start 0 epoch
2024-04-09 10:26:11,302 - root - INFO - epoch: 0
2024-04-09 10:26:11,302 - root - INFO - total memory use: 308.15 MB
2024-04-09 10:26:11,302 - root - INFO - train time: 22.52 s
2024-04-09 10:26:11,302 - root - INFO - Epoch mean loss: 1.0104109037819098
2024-04-09 10:26:11,302 - root - INFO - train acc: 0.7336, val acc: 0.7124, new node val acc: 0.7202
2024-04-09 10:26:11,302 - root - INFO - train auc: 0.8216, val auc: 0.7926, new node val auc: 0.8045
2024-04-09 10:26:11,302 - root - INFO - train ap: 0.8291, val ap: 0.8136, new node val ap: 0.8278
2024-04-09 10:26:11,303 - root - INFO - train recall: 0.7504, val recall: 0.7325, new node val recall: 0.7457
2024-04-09 10:26:12,248 - root - INFO - start 1 epoch
2024-04-09 10:26:56,506 - root - INFO - epoch: 1
2024-04-09 10:26:56,507 - root - INFO - total memory use: 616.30 MB
2024-04-09 10:26:56,507 - root - INFO - train time: 22.25 s
2024-04-09 10:26:56,507 - root - INFO - Epoch mean loss: 0.9129749151399191
2024-04-09 10:26:56,507 - root - INFO - train acc: 0.7730, val acc: 0.7217, new node val acc: 0.7273
2024-04-09 10:26:56,507 - root - INFO - train auc: 0.8603, val auc: 0.8081, new node val auc: 0.8176
2024-04-09 10:26:56,507 - root - INFO - train ap: 0.8641, val ap: 0.8249, new node val ap: 0.8372
2024-04-09 10:26:56,507 - root - INFO - train recall: 0.7890, val recall: 0.7646, new node val recall: 0.7720
2024-04-09 10:26:57,166 - root - INFO - start 2 epoch
2024-04-09 10:27:35,362 - root - INFO - epoch: 2
2024-04-09 10:27:35,363 - root - INFO - total memory use: 924.45 MB
2024-04-09 10:27:35,363 - root - INFO - train time: 19.66 s
2024-04-09 10:27:35,363 - root - INFO - Epoch mean loss: 0.8784399523173543
2024-04-09 10:27:35,363 - root - INFO - train acc: 0.7861, val acc: 0.7391, new node val acc: 0.7437
2024-04-09 10:27:35,363 - root - INFO - train auc: 0.8728, val auc: 0.8230, new node val auc: 0.8302
2024-04-09 10:27:35,364 - root - INFO - train ap: 0.8768, val ap: 0.8363, new node val ap: 0.8456
2024-04-09 10:27:35,364 - root - INFO - train recall: 0.7997, val recall: 0.7119, new node val recall: 0.7223
2024-04-09 10:27:36,069 - root - INFO - start 3 epoch
2024-04-09 10:28:16,716 - root - INFO - epoch: 3
2024-04-09 10:28:16,716 - root - INFO - total memory use: 1232.60 MB
2024-04-09 10:28:16,716 - root - INFO - train time: 19.47 s
2024-04-09 10:28:16,717 - root - INFO - Epoch mean loss: 0.8454348486095997
2024-04-09 10:28:16,717 - root - INFO - train acc: 0.7950, val acc: 0.7446, new node val acc: 0.7448
2024-04-09 10:28:16,717 - root - INFO - train auc: 0.8832, val auc: 0.8284, new node val auc: 0.8300
2024-04-09 10:28:16,717 - root - INFO - train ap: 0.8877, val ap: 0.8438, new node val ap: 0.8469
2024-04-09 10:28:16,717 - root - INFO - train recall: 0.8060, val recall: 0.7299, new node val recall: 0.7370
2024-04-09 10:28:17,338 - root - INFO - start 4 epoch
2024-04-09 10:29:03,780 - root - INFO - epoch: 4
2024-04-09 10:29:03,780 - root - INFO - total memory use: 1540.75 MB
2024-04-09 10:29:03,780 - root - INFO - train time: 22.69 s
2024-04-09 10:29:03,780 - root - INFO - Epoch mean loss: 0.8276105368401943
2024-04-09 10:29:03,781 - root - INFO - train acc: 0.8003, val acc: 0.7451, new node val acc: 0.7465
2024-04-09 10:29:03,781 - root - INFO - train auc: 0.8878, val auc: 0.8318, new node val auc: 0.8334
2024-04-09 10:29:03,781 - root - INFO - train ap: 0.8927, val ap: 0.8450, new node val ap: 0.8512
2024-04-09 10:29:03,781 - root - INFO - train recall: 0.8111, val recall: 0.7434, new node val recall: 0.7474
2024-04-09 10:29:04,412 - root - INFO - start 5 epoch
2024-04-09 10:29:50,119 - root - INFO - epoch: 5
2024-04-09 10:29:50,119 - root - INFO - total memory use: 1848.90 MB
2024-04-09 10:29:50,119 - root - INFO - train time: 22.24 s
2024-04-09 10:29:50,119 - root - INFO - Epoch mean loss: 0.8211158929270969
2024-04-09 10:29:50,119 - root - INFO - train acc: 0.8031, val acc: 0.7492, new node val acc: 0.7479
2024-04-09 10:29:50,119 - root - INFO - train auc: 0.8899, val auc: 0.8345, new node val auc: 0.8356
2024-04-09 10:29:50,119 - root - INFO - train ap: 0.8939, val ap: 0.8479, new node val ap: 0.8524
2024-04-09 10:29:50,119 - root - INFO - train recall: 0.8119, val recall: 0.7516, new node val recall: 0.7533
2024-04-09 10:29:50,739 - root - INFO - start 6 epoch
2024-04-09 10:30:35,598 - root - INFO - epoch: 6
2024-04-09 10:30:35,598 - root - INFO - total memory use: 2157.05 MB
2024-04-09 10:30:35,598 - root - INFO - train time: 22.70 s
2024-04-09 10:30:35,598 - root - INFO - Epoch mean loss: 0.814841040627142
2024-04-09 10:30:35,598 - root - INFO - train acc: 0.8045, val acc: 0.7488, new node val acc: 0.7532
2024-04-09 10:30:35,599 - root - INFO - train auc: 0.8914, val auc: 0.8358, new node val auc: 0.8384
2024-04-09 10:30:35,599 - root - INFO - train ap: 0.8953, val ap: 0.8498, new node val ap: 0.8545
2024-04-09 10:30:35,599 - root - INFO - train recall: 0.8112, val recall: 0.7362, new node val recall: 0.7424
2024-04-09 10:30:36,305 - root - INFO - start 7 epoch
2024-04-09 10:31:22,034 - root - INFO - epoch: 7
2024-04-09 10:31:22,034 - root - INFO - total memory use: 2465.20 MB
2024-04-09 10:31:22,034 - root - INFO - train time: 22.53 s
2024-04-09 10:31:22,034 - root - INFO - Epoch mean loss: 0.8000445790340809
2024-04-09 10:31:22,034 - root - INFO - train acc: 0.8095, val acc: 0.7485, new node val acc: 0.7468
2024-04-09 10:31:22,034 - root - INFO - train auc: 0.8958, val auc: 0.8323, new node val auc: 0.8324
2024-04-09 10:31:22,034 - root - INFO - train ap: 0.8997, val ap: 0.8450, new node val ap: 0.8478
2024-04-09 10:31:22,034 - root - INFO - train recall: 0.8170, val recall: 0.7437, new node val recall: 0.7440
2024-04-09 10:31:22,693 - root - INFO - start 8 epoch
2024-04-09 10:32:08,847 - root - INFO - epoch: 8
2024-04-09 10:32:08,847 - root - INFO - total memory use: 2773.35 MB
2024-04-09 10:32:08,847 - root - INFO - train time: 22.74 s
2024-04-09 10:32:08,847 - root - INFO - Epoch mean loss: 0.7866182574582011
2024-04-09 10:32:08,848 - root - INFO - train acc: 0.8131, val acc: 0.7522, new node val acc: 0.7520
2024-04-09 10:32:08,848 - root - INFO - train auc: 0.8994, val auc: 0.8378, new node val auc: 0.8362
2024-04-09 10:32:08,848 - root - INFO - train ap: 0.9036, val ap: 0.8509, new node val ap: 0.8523
2024-04-09 10:32:08,848 - root - INFO - train recall: 0.8183, val recall: 0.7304, new node val recall: 0.7294
2024-04-09 10:32:09,536 - root - INFO - start 9 epoch
2024-04-09 10:32:54,313 - root - INFO - epoch: 9
2024-04-09 10:32:54,314 - root - INFO - total memory use: 3081.50 MB
2024-04-09 10:32:54,314 - root - INFO - train time: 22.28 s
2024-04-09 10:32:54,314 - root - INFO - Epoch mean loss: 0.7907158267189336
2024-04-09 10:32:54,314 - root - INFO - train acc: 0.8118, val acc: 0.7556, new node val acc: 0.7510
2024-04-09 10:32:54,314 - root - INFO - train auc: 0.8984, val auc: 0.8426, new node val auc: 0.8378
2024-04-09 10:32:54,314 - root - INFO - train ap: 0.9024, val ap: 0.8540, new node val ap: 0.8515
2024-04-09 10:32:54,314 - root - INFO - train recall: 0.8188, val recall: 0.7218, new node val recall: 0.7177
2024-04-09 10:32:54,914 - root - INFO - start 10 epoch
2024-04-09 10:33:27,895 - root - INFO - epoch: 10
2024-04-09 10:33:27,895 - root - INFO - total memory use: 3389.65 MB
2024-04-09 10:33:27,895 - root - INFO - train time: 18.12 s
2024-04-09 10:33:27,895 - root - INFO - Epoch mean loss: 0.7853131371787974
2024-04-09 10:33:27,895 - root - INFO - train acc: 0.8130, val acc: 0.7584, new node val acc: 0.7537
2024-04-09 10:33:27,895 - root - INFO - train auc: 0.8999, val auc: 0.8450, new node val auc: 0.8420
2024-04-09 10:33:27,895 - root - INFO - train ap: 0.9035, val ap: 0.8580, new node val ap: 0.8570
2024-04-09 10:33:27,895 - root - INFO - train recall: 0.8188, val recall: 0.7323, new node val recall: 0.7305
2024-04-09 10:33:28,572 - root - INFO - start 11 epoch
2024-04-09 10:34:00,539 - root - INFO - epoch: 11
2024-04-09 10:34:00,540 - root - INFO - total memory use: 3697.80 MB
2024-04-09 10:34:00,540 - root - INFO - train time: 16.23 s
2024-04-09 10:34:00,540 - root - INFO - Epoch mean loss: 0.7748263789164006
2024-04-09 10:34:00,540 - root - INFO - train acc: 0.8161, val acc: 0.7597, new node val acc: 0.7558
2024-04-09 10:34:00,540 - root - INFO - train auc: 0.9028, val auc: 0.8477, new node val auc: 0.8433
2024-04-09 10:34:00,540 - root - INFO - train ap: 0.9064, val ap: 0.8597, new node val ap: 0.8577
2024-04-09 10:34:00,540 - root - INFO - train recall: 0.8220, val recall: 0.7380, new node val recall: 0.7374
2024-04-09 10:34:01,254 - root - INFO - start 12 epoch
2024-04-09 10:34:39,936 - root - INFO - epoch: 12
2024-04-09 10:34:39,936 - root - INFO - total memory use: 4005.95 MB
2024-04-09 10:34:39,936 - root - INFO - train time: 19.74 s
2024-04-09 10:34:39,936 - root - INFO - Epoch mean loss: 0.7701657882968536
2024-04-09 10:34:39,936 - root - INFO - train acc: 0.8179, val acc: 0.7571, new node val acc: 0.7576
2024-04-09 10:34:39,936 - root - INFO - train auc: 0.9043, val auc: 0.8449, new node val auc: 0.8440
2024-04-09 10:34:39,937 - root - INFO - train ap: 0.9080, val ap: 0.8569, new node val ap: 0.8561
2024-04-09 10:34:39,937 - root - INFO - train recall: 0.8229, val recall: 0.7071, new node val recall: 0.7065
2024-04-09 10:34:40,560 - root - INFO - start 13 epoch
2024-04-09 10:35:19,573 - root - INFO - epoch: 13
2024-04-09 10:35:19,573 - root - INFO - total memory use: 4314.10 MB
2024-04-09 10:35:19,573 - root - INFO - train time: 19.45 s
2024-04-09 10:35:19,574 - root - INFO - Epoch mean loss: 0.766787657351147
2024-04-09 10:35:19,574 - root - INFO - train acc: 0.8184, val acc: 0.7629, new node val acc: 0.7580
2024-04-09 10:35:19,574 - root - INFO - train auc: 0.9049, val auc: 0.8497, new node val auc: 0.8451
2024-04-09 10:35:19,574 - root - INFO - train ap: 0.9088, val ap: 0.8609, new node val ap: 0.8585
2024-04-09 10:35:19,574 - root - INFO - train recall: 0.8249, val recall: 0.7408, new node val recall: 0.7380
2024-04-09 10:35:20,304 - root - INFO - start 14 epoch
2024-04-09 10:35:59,528 - root - INFO - epoch: 14
2024-04-09 10:35:59,529 - root - INFO - total memory use: 4622.25 MB
2024-04-09 10:35:59,529 - root - INFO - train time: 19.95 s
2024-04-09 10:35:59,529 - root - INFO - Epoch mean loss: 0.7615676243340485
2024-04-09 10:35:59,529 - root - INFO - train acc: 0.8203, val acc: 0.7650, new node val acc: 0.7616
2024-04-09 10:35:59,529 - root - INFO - train auc: 0.9065, val auc: 0.8526, new node val auc: 0.8479
2024-04-09 10:35:59,529 - root - INFO - train ap: 0.9104, val ap: 0.8644, new node val ap: 0.8604
2024-04-09 10:35:59,529 - root - INFO - train recall: 0.8253, val recall: 0.7376, new node val recall: 0.7297
2024-04-09 10:36:00,206 - root - INFO - start 15 epoch
2024-04-09 10:36:33,260 - root - INFO - epoch: 15
2024-04-09 10:36:33,260 - root - INFO - total memory use: 4930.40 MB
2024-04-09 10:36:33,260 - root - INFO - train time: 17.35 s
2024-04-09 10:36:33,260 - root - INFO - Epoch mean loss: 0.7537727726740548
2024-04-09 10:36:33,260 - root - INFO - train acc: 0.8212, val acc: 0.7628, new node val acc: 0.7623
2024-04-09 10:36:33,260 - root - INFO - train auc: 0.9085, val auc: 0.8479, new node val auc: 0.8485
2024-04-09 10:36:33,260 - root - INFO - train ap: 0.9123, val ap: 0.8597, new node val ap: 0.8618
2024-04-09 10:36:33,260 - root - INFO - train recall: 0.8248, val recall: 0.7391, new node val recall: 0.7426
2024-04-09 10:36:33,927 - root - INFO - start 16 epoch
2024-04-09 10:37:05,244 - root - INFO - epoch: 16
2024-04-09 10:37:05,244 - root - INFO - total memory use: 5238.55 MB
2024-04-09 10:37:05,244 - root - INFO - train time: 15.55 s
2024-04-09 10:37:05,244 - root - INFO - Epoch mean loss: 0.7493247201645565
2024-04-09 10:37:05,245 - root - INFO - train acc: 0.8236, val acc: 0.7674, new node val acc: 0.7650
2024-04-09 10:37:05,245 - root - INFO - train auc: 0.9097, val auc: 0.8552, new node val auc: 0.8522
2024-04-09 10:37:05,245 - root - INFO - train ap: 0.9136, val ap: 0.8658, new node val ap: 0.8655
2024-04-09 10:37:05,245 - root - INFO - train recall: 0.8286, val recall: 0.7181, new node val recall: 0.7175
2024-04-09 10:37:05,919 - root - INFO - start 17 epoch
2024-04-09 10:37:37,237 - root - INFO - epoch: 17
2024-04-09 10:37:37,237 - root - INFO - total memory use: 5546.70 MB
2024-04-09 10:37:37,237 - root - INFO - train time: 16.49 s
2024-04-09 10:37:37,237 - root - INFO - Epoch mean loss: 0.7431435591636545
2024-04-09 10:37:37,237 - root - INFO - train acc: 0.8249, val acc: 0.7653, new node val acc: 0.7632
2024-04-09 10:37:37,237 - root - INFO - train auc: 0.9113, val auc: 0.8544, new node val auc: 0.8494
2024-04-09 10:37:37,237 - root - INFO - train ap: 0.9151, val ap: 0.8651, new node val ap: 0.8622
2024-04-09 10:37:37,238 - root - INFO - train recall: 0.8289, val recall: 0.7695, new node val recall: 0.7648
2024-04-09 10:37:37,897 - root - INFO - start 18 epoch
2024-04-09 10:38:10,098 - root - INFO - epoch: 18
2024-04-09 10:38:10,098 - root - INFO - total memory use: 5854.86 MB
2024-04-09 10:38:10,098 - root - INFO - train time: 17.16 s
2024-04-09 10:38:10,098 - root - INFO - Epoch mean loss: 0.7379892891417597
2024-04-09 10:38:10,098 - root - INFO - train acc: 0.8270, val acc: 0.7706, new node val acc: 0.7594
2024-04-09 10:38:10,098 - root - INFO - train auc: 0.9127, val auc: 0.8581, new node val auc: 0.8477
2024-04-09 10:38:10,098 - root - INFO - train ap: 0.9161, val ap: 0.8685, new node val ap: 0.8602
2024-04-09 10:38:10,098 - root - INFO - train recall: 0.8319, val recall: 0.7560, new node val recall: 0.7463
2024-04-09 10:38:10,840 - root - INFO - start 19 epoch
2024-04-09 10:38:38,155 - root - INFO - epoch: 19
2024-04-09 10:38:38,155 - root - INFO - total memory use: 6163.01 MB
2024-04-09 10:38:38,155 - root - INFO - train time: 14.76 s
2024-04-09 10:38:38,155 - root - INFO - Epoch mean loss: 0.7349278991157706
2024-04-09 10:38:38,156 - root - INFO - train acc: 0.8287, val acc: 0.7672, new node val acc: 0.7567
2024-04-09 10:38:38,156 - root - INFO - train auc: 0.9136, val auc: 0.8534, new node val auc: 0.8472
2024-04-09 10:38:38,156 - root - INFO - train ap: 0.9169, val ap: 0.8641, new node val ap: 0.8607
2024-04-09 10:38:38,156 - root - INFO - train recall: 0.8330, val recall: 0.7301, new node val recall: 0.7223
2024-04-09 10:38:38,881 - root - INFO - start 20 epoch
2024-04-09 10:39:06,492 - root - INFO - epoch: 20
2024-04-09 10:39:06,492 - root - INFO - total memory use: 6471.16 MB
2024-04-09 10:39:06,492 - root - INFO - train time: 14.73 s
2024-04-09 10:39:06,492 - root - INFO - Epoch mean loss: 0.7272871639740306
2024-04-09 10:39:06,493 - root - INFO - train acc: 0.8302, val acc: 0.7692, new node val acc: 0.7623
2024-04-09 10:39:06,493 - root - INFO - train auc: 0.9153, val auc: 0.8574, new node val auc: 0.8495
2024-04-09 10:39:06,493 - root - INFO - train ap: 0.9185, val ap: 0.8685, new node val ap: 0.8627
2024-04-09 10:39:06,493 - root - INFO - train recall: 0.8346, val recall: 0.7560, new node val recall: 0.7480
2024-04-09 10:39:07,207 - root - INFO - start 21 epoch
2024-04-09 10:39:34,855 - root - INFO - epoch: 21
2024-04-09 10:39:34,856 - root - INFO - total memory use: 6779.31 MB
2024-04-09 10:39:34,856 - root - INFO - train time: 14.69 s
2024-04-09 10:39:34,856 - root - INFO - Epoch mean loss: 0.723668538833223
2024-04-09 10:39:34,856 - root - INFO - train acc: 0.8310, val acc: 0.7710, new node val acc: 0.7623
2024-04-09 10:39:34,856 - root - INFO - train auc: 0.9162, val auc: 0.8572, new node val auc: 0.8483
2024-04-09 10:39:34,856 - root - INFO - train ap: 0.9197, val ap: 0.8677, new node val ap: 0.8611
2024-04-09 10:39:34,856 - root - INFO - train recall: 0.8336, val recall: 0.7336, new node val recall: 0.7318
2024-04-09 10:39:34,856 - root - INFO - No improvment over 3 epochs, stop training
2024-04-09 10:39:34,857 - root - INFO - Loading the best model at epoch 19
2024-04-09 10:39:35,018 - root - INFO - Loaded the best model at epoch 19 for inference
2024-04-09 10:39:35,019 - root - INFO - early stop total time: 423.30 s
2024-04-09 10:39:35,019 - root - INFO - early stop average time: 19.24 s
2024-04-09 10:39:35,019 - root - INFO - average memory use: 308.15 MB
2024-04-09 10:39:45,860 - root - INFO - Test statistics: Old nodes -- acc: 0.7549, auc: 0.8400, ap: 0.8510, recall: 0.7135
2024-04-09 10:39:45,860 - root - INFO - Test statistics: New nodes -- acc: 0.7428, auc: 0.8290, ap: 0.8445, recall: 0.7049
2024-04-09 10:39:45,860 - root - INFO - total time: 423.30 s
2024-04-09 10:39:45,860 - root - INFO - complete average time: 19.24 s
2024-04-09 10:39:45,860 - root - INFO - average memory use: 308.15 MB
2024-04-09 10:39:45,860 - root - INFO - Saving TGAN model
2024-04-09 10:39:46,568 - root - INFO - TGAN models saved
