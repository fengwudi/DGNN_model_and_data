2024-04-09 10:25:40,137 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=500, data='Flights', drop_out=0.1, gpu=3, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='flight500', time='time', time_dim=100, uniform=True)
2024-04-09 10:25:56,460 - module - INFO - Aggregation uses attention model
2024-04-09 10:25:56,483 - module - INFO - Using scaled prod attention
2024-04-09 10:25:56,483 - module - INFO - Using time encoding
2024-04-09 10:25:58,966 - root - INFO - num of training instances: 1102788
2024-04-09 10:25:58,966 - root - INFO - num of batches per epoch: 2206
2024-04-09 10:25:59,019 - root - INFO - start 0 epoch
2024-04-09 10:30:31,897 - root - INFO - epoch: 0
2024-04-09 10:30:31,897 - root - INFO - total memory use: 2963.30 MB
2024-04-09 10:30:31,897 - root - INFO - train time: 111.35 s
2024-04-09 10:30:31,897 - root - INFO - Epoch mean loss: 1.0778490982591729
2024-04-09 10:30:31,897 - root - INFO - train acc: 0.7214, val acc: 0.6376, new node val acc: 0.6377
2024-04-09 10:30:31,898 - root - INFO - train auc: 0.7747, val auc: 0.7033, new node val auc: 0.7025
2024-04-09 10:30:31,898 - root - INFO - train ap: 0.7243, val ap: 0.6791, new node val ap: 0.6799
2024-04-09 10:30:31,898 - root - INFO - train recall: 0.8314, val recall: 0.6466, new node val recall: 0.6477
2024-04-09 10:30:40,274 - root - INFO - start 1 epoch
2024-04-09 10:35:16,164 - root - INFO - epoch: 1
2024-04-09 10:35:16,165 - root - INFO - total memory use: 5926.60 MB
2024-04-09 10:35:16,165 - root - INFO - train time: 114.81 s
2024-04-09 10:35:16,165 - root - INFO - Epoch mean loss: 1.0705186441229997
2024-04-09 10:35:16,165 - root - INFO - train acc: 0.7244, val acc: 0.6396, new node val acc: 0.6432
2024-04-09 10:35:16,165 - root - INFO - train auc: 0.7781, val auc: 0.7019, new node val auc: 0.7038
2024-04-09 10:35:16,165 - root - INFO - train ap: 0.7283, val ap: 0.6783, new node val ap: 0.6804
2024-04-09 10:35:16,166 - root - INFO - train recall: 0.8369, val recall: 0.6710, new node val recall: 0.6753
2024-04-09 10:35:23,874 - root - INFO - start 2 epoch
2024-04-09 10:39:44,555 - root - INFO - epoch: 2
2024-04-09 10:39:44,555 - root - INFO - total memory use: 8889.90 MB
2024-04-09 10:39:44,555 - root - INFO - train time: 105.94 s
2024-04-09 10:39:44,555 - root - INFO - Epoch mean loss: 1.0681572954490417
2024-04-09 10:39:44,555 - root - INFO - train acc: 0.7251, val acc: 0.6461, new node val acc: 0.6477
2024-04-09 10:39:44,556 - root - INFO - train auc: 0.7792, val auc: 0.7024, new node val auc: 0.7043
2024-04-09 10:39:44,556 - root - INFO - train ap: 0.7297, val ap: 0.6790, new node val ap: 0.6826
2024-04-09 10:39:44,556 - root - INFO - train recall: 0.8378, val recall: 0.7411, new node val recall: 0.7443
2024-04-09 10:39:52,246 - root - INFO - start 3 epoch
2024-04-09 10:44:13,623 - root - INFO - epoch: 3
2024-04-09 10:44:13,623 - root - INFO - total memory use: 11853.20 MB
2024-04-09 10:44:13,623 - root - INFO - train time: 103.49 s
2024-04-09 10:44:13,623 - root - INFO - Epoch mean loss: 1.0675297505944183
2024-04-09 10:44:13,623 - root - INFO - train acc: 0.7254, val acc: 0.6242, new node val acc: 0.6258
2024-04-09 10:44:13,623 - root - INFO - train auc: 0.7796, val auc: 0.7029, new node val auc: 0.7050
2024-04-09 10:44:13,623 - root - INFO - train ap: 0.7304, val ap: 0.6784, new node val ap: 0.6810
2024-04-09 10:44:13,624 - root - INFO - train recall: 0.8386, val recall: 0.5410, new node val recall: 0.5421
2024-04-09 10:44:13,624 - root - INFO - No improvment over 3 epochs, stop training
2024-04-09 10:44:13,624 - root - INFO - Loading the best model at epoch 0
2024-04-09 10:44:15,257 - root - INFO - Loaded the best model at epoch 0 for inference
2024-04-09 10:44:15,257 - root - INFO - early stop total time: 435.60 s
2024-04-09 10:44:15,257 - root - INFO - early stop average time: 108.90 s
2024-04-09 10:44:15,257 - root - INFO - average memory use: 2963.30 MB
2024-04-09 10:46:41,969 - root - INFO - Test statistics: Old nodes -- acc: 0.6354, auc: 0.7007, ap: 0.6798, recall: 0.6354
2024-04-09 10:46:41,969 - root - INFO - Test statistics: New nodes -- acc: 0.5557, auc: 0.5868, ap: 0.5969, recall: 0.6375
2024-04-09 10:46:41,969 - root - INFO - total time: 435.60 s
2024-04-09 10:46:41,969 - root - INFO - complete average time: 108.90 s
2024-04-09 10:46:41,969 - root - INFO - average memory use: 2963.30 MB
2024-04-09 10:46:41,969 - root - INFO - Saving TGAN model
2024-04-09 10:46:48,913 - root - INFO - TGAN models saved
