2024-04-17 10:53:48,269 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='dgraphfin', drop_out=0.1, gpu=1, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='dgraphfin', time='time', time_dim=100, uniform=True)
2024-04-17 10:54:49,302 - module - INFO - Aggregation uses attention model
2024-04-17 10:54:49,318 - module - INFO - Using scaled prod attention
2024-04-17 10:54:49,318 - module - INFO - Using time encoding
2024-04-17 10:54:52,540 - root - INFO - num of training instances: 2693637
2024-04-17 10:54:52,540 - root - INFO - num of batches per epoch: 2694
2024-04-17 10:54:52,621 - root - INFO - start 0 epoch
2024-04-17 11:00:48,732 - root - INFO - epoch: 0
2024-04-17 11:00:48,732 - root - INFO - total memory use: 13216.72 MB
2024-04-17 11:00:48,732 - root - INFO - train time: 69.72 s
2024-04-17 11:00:48,732 - root - INFO - Epoch mean loss: 1.3715851186112997
2024-04-17 11:00:48,732 - root - INFO - train acc: 0.5288, val acc: 0.5086, new node val acc: 0.5094
2024-04-17 11:00:48,732 - root - INFO - train auc: 0.5338, val auc: 0.5418, new node val auc: 0.5481
2024-04-17 11:00:48,733 - root - INFO - train ap: 0.5324, val ap: 0.5337, new node val ap: 0.5362
2024-04-17 11:00:48,733 - root - INFO - train recall: 0.6414, val recall: 0.2086, new node val recall: 0.2132
2024-04-17 11:01:21,383 - root - INFO - start 1 epoch
2024-04-17 11:07:16,292 - root - INFO - epoch: 1
2024-04-17 11:07:16,292 - root - INFO - total memory use: 26433.44 MB
2024-04-17 11:07:16,292 - root - INFO - train time: 69.59 s
2024-04-17 11:07:16,292 - root - INFO - Epoch mean loss: 1.369794171964494
2024-04-17 11:07:16,293 - root - INFO - train acc: 0.5302, val acc: 0.5329, new node val acc: 0.5386
2024-04-17 11:07:16,293 - root - INFO - train auc: 0.5348, val auc: 0.5471, new node val auc: 0.5549
2024-04-17 11:07:16,293 - root - INFO - train ap: 0.5339, val ap: 0.5369, new node val ap: 0.5403
2024-04-17 11:07:16,293 - root - INFO - train recall: 0.6267, val recall: 0.6471, new node val recall: 0.6622
2024-04-17 11:07:48,941 - root - INFO - start 2 epoch
2024-04-17 11:13:44,722 - root - INFO - epoch: 2
2024-04-17 11:13:44,723 - root - INFO - total memory use: 39650.16 MB
2024-04-17 11:13:44,723 - root - INFO - train time: 69.43 s
2024-04-17 11:13:44,723 - root - INFO - Epoch mean loss: 1.3702393721542983
2024-04-17 11:13:44,723 - root - INFO - train acc: 0.5305, val acc: 0.5441, new node val acc: 0.5522
2024-04-17 11:13:44,723 - root - INFO - train auc: 0.5354, val auc: 0.5536, new node val auc: 0.5641
2024-04-17 11:13:44,724 - root - INFO - train ap: 0.5346, val ap: 0.5408, new node val ap: 0.5460
2024-04-17 11:13:44,724 - root - INFO - train recall: 0.6484, val recall: 0.8460, new node val recall: 0.8623
2024-04-17 11:14:25,791 - root - INFO - start 3 epoch
2024-04-17 11:20:23,412 - root - INFO - epoch: 3
2024-04-17 11:20:23,412 - root - INFO - total memory use: 52866.88 MB
2024-04-17 11:20:23,412 - root - INFO - train time: 70.43 s
2024-04-17 11:20:23,413 - root - INFO - Epoch mean loss: 1.3680254404157202
2024-04-17 11:20:23,413 - root - INFO - train acc: 0.5317, val acc: 0.5452, new node val acc: 0.5533
2024-04-17 11:20:23,413 - root - INFO - train auc: 0.5357, val auc: 0.5553, new node val auc: 0.5660
2024-04-17 11:20:23,413 - root - INFO - train ap: 0.5352, val ap: 0.5420, new node val ap: 0.5474
2024-04-17 11:20:23,413 - root - INFO - train recall: 0.6195, val recall: 0.8401, new node val recall: 0.8568
2024-04-17 11:21:03,655 - root - INFO - start 4 epoch
2024-04-17 11:28:06,314 - root - INFO - epoch: 4
2024-04-17 11:28:06,314 - root - INFO - total memory use: 66083.59 MB
2024-04-17 11:28:06,314 - root - INFO - train time: 94.78 s
2024-04-17 11:28:06,314 - root - INFO - Epoch mean loss: 1.3685060904569422
2024-04-17 11:28:06,315 - root - INFO - train acc: 0.5313, val acc: 0.5452, new node val acc: 0.5534
2024-04-17 11:28:06,315 - root - INFO - train auc: 0.5359, val auc: 0.5547, new node val auc: 0.5653
2024-04-17 11:28:06,315 - root - INFO - train ap: 0.5353, val ap: 0.5421, new node val ap: 0.5475
2024-04-17 11:28:06,315 - root - INFO - train recall: 0.6378, val recall: 0.8456, new node val recall: 0.8622
2024-04-17 11:28:44,598 - root - INFO - start 5 epoch
2024-04-17 11:35:52,782 - root - INFO - epoch: 5
2024-04-17 11:35:52,782 - root - INFO - total memory use: 79300.31 MB
2024-04-17 11:35:52,782 - root - INFO - train time: 70.54 s
2024-04-17 11:35:52,783 - root - INFO - Epoch mean loss: 1.3680347309523189
2024-04-17 11:35:52,783 - root - INFO - train acc: 0.5318, val acc: 0.5463, new node val acc: 0.5548
2024-04-17 11:35:52,783 - root - INFO - train auc: 0.5360, val auc: 0.5558, new node val auc: 0.5675
2024-04-17 11:35:52,783 - root - INFO - train ap: 0.5356, val ap: 0.5422, new node val ap: 0.5483
2024-04-17 11:35:52,784 - root - INFO - train recall: 0.6193, val recall: 0.8405, new node val recall: 0.8574
2024-04-17 11:36:36,494 - root - INFO - start 6 epoch
2024-04-17 11:44:33,827 - root - INFO - epoch: 6
2024-04-17 11:44:33,828 - root - INFO - total memory use: 92517.03 MB
2024-04-17 11:44:33,828 - root - INFO - train time: 100.80 s
2024-04-17 11:44:33,828 - root - INFO - Epoch mean loss: 1.3672627557093955
2024-04-17 11:44:33,829 - root - INFO - train acc: 0.5318, val acc: 0.5476, new node val acc: 0.5565
2024-04-17 11:44:33,829 - root - INFO - train auc: 0.5361, val auc: 0.5543, new node val auc: 0.5644
2024-04-17 11:44:33,829 - root - INFO - train ap: 0.5358, val ap: 0.5400, new node val ap: 0.5449
2024-04-17 11:44:33,830 - root - INFO - train recall: 0.6221, val recall: 0.8345, new node val recall: 0.8521
2024-04-17 11:44:33,830 - root - INFO - No improvment over 3 epochs, stop training
2024-04-17 11:44:33,830 - root - INFO - Loading the best model at epoch 4
2024-04-17 11:44:42,571 - root - INFO - Loaded the best model at epoch 4 for inference
2024-04-17 11:44:42,571 - root - INFO - early stop total time: 545.29 s
2024-04-17 11:44:42,571 - root - INFO - early stop average time: 77.90 s
2024-04-17 11:44:42,571 - root - INFO - average memory use: 13216.72 MB
2024-04-17 11:50:33,948 - root - INFO - Test statistics: Old nodes -- acc: 0.5518, auc: 0.5776, ap: 0.5594, recall: 0.8680
2024-04-17 11:50:33,948 - root - INFO - Test statistics: New nodes -- acc: 0.5632, auc: 0.5774, ap: 0.5576, recall: 0.8773
2024-04-17 11:50:33,948 - root - INFO - total time: 545.29 s
2024-04-17 11:50:33,948 - root - INFO - complete average time: 77.90 s
2024-04-17 11:50:33,948 - root - INFO - average memory use: 13216.72 MB
2024-04-17 11:50:33,948 - root - INFO - Saving TGAN model
2024-04-17 11:51:17,861 - root - INFO - TGAN models saved
