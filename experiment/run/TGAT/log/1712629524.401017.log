2024-04-09 10:25:24,401 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=2000, data='wikipedia', drop_out=0.1, gpu=0, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='wiki2000', time='time', time_dim=100, uniform=True)
2024-04-09 10:25:25,270 - module - INFO - Aggregation uses attention model
2024-04-09 10:25:25,286 - module - INFO - Using scaled prod attention
2024-04-09 10:25:25,286 - module - INFO - Using time encoding
2024-04-09 10:25:27,782 - root - INFO - num of training instances: 81029
2024-04-09 10:25:27,782 - root - INFO - num of batches per epoch: 41
2024-04-09 10:25:27,784 - root - INFO - start 0 epoch
2024-04-09 10:25:57,518 - root - INFO - epoch: 0
2024-04-09 10:25:57,518 - root - INFO - total memory use: 1321.32 MB
2024-04-09 10:25:57,518 - root - INFO - train time: 7.09 s
2024-04-09 10:25:57,519 - root - INFO - Epoch mean loss: 1.1707772452656815
2024-04-09 10:25:57,519 - root - INFO - train acc: 0.6608, val acc: 0.6500, new node val acc: 0.6793
2024-04-09 10:25:57,519 - root - INFO - train auc: 0.7382, val auc: 0.7251, new node val auc: 0.7532
2024-04-09 10:25:57,519 - root - INFO - train ap: 0.7567, val ap: 0.7653, new node val ap: 0.7953
2024-04-09 10:25:57,519 - root - INFO - train recall: 0.6268, val recall: 0.6021, new node val recall: 0.6497
2024-04-09 10:25:58,234 - root - INFO - start 1 epoch
2024-04-09 10:26:30,042 - root - INFO - epoch: 1
2024-04-09 10:26:30,042 - root - INFO - total memory use: 2642.63 MB
2024-04-09 10:26:30,042 - root - INFO - train time: 9.32 s
2024-04-09 10:26:30,042 - root - INFO - Epoch mean loss: 1.0463087398831437
2024-04-09 10:26:30,042 - root - INFO - train acc: 0.7077, val acc: 0.6402, new node val acc: 0.6559
2024-04-09 10:26:30,042 - root - INFO - train auc: 0.7987, val auc: 0.7218, new node val auc: 0.7461
2024-04-09 10:26:30,042 - root - INFO - train ap: 0.8150, val ap: 0.7634, new node val ap: 0.7891
2024-04-09 10:26:30,042 - root - INFO - train recall: 0.6765, val recall: 0.7061, new node val recall: 0.7245
2024-04-09 10:26:30,699 - root - INFO - start 2 epoch
2024-04-09 10:26:58,730 - root - INFO - epoch: 2
2024-04-09 10:26:58,730 - root - INFO - total memory use: 3963.95 MB
2024-04-09 10:26:58,730 - root - INFO - train time: 7.85 s
2024-04-09 10:26:58,730 - root - INFO - Epoch mean loss: 1.0320275382297794
2024-04-09 10:26:58,730 - root - INFO - train acc: 0.7208, val acc: 0.6827, new node val acc: 0.7048
2024-04-09 10:26:58,731 - root - INFO - train auc: 0.8095, val auc: 0.7635, new node val auc: 0.7899
2024-04-09 10:26:58,731 - root - INFO - train ap: 0.8241, val ap: 0.7957, new node val ap: 0.8210
2024-04-09 10:26:58,731 - root - INFO - train recall: 0.7008, val recall: 0.7161, new node val recall: 0.7538
2024-04-09 10:26:59,388 - root - INFO - start 3 epoch
2024-04-09 10:27:25,750 - root - INFO - epoch: 3
2024-04-09 10:27:25,751 - root - INFO - total memory use: 5285.27 MB
2024-04-09 10:27:25,751 - root - INFO - train time: 7.43 s
2024-04-09 10:27:25,751 - root - INFO - Epoch mean loss: 0.9945717642946941
2024-04-09 10:27:25,751 - root - INFO - train acc: 0.7365, val acc: 0.6778, new node val acc: 0.7006
2024-04-09 10:27:25,751 - root - INFO - train auc: 0.8274, val auc: 0.7616, new node val auc: 0.7842
2024-04-09 10:27:25,751 - root - INFO - train ap: 0.8390, val ap: 0.7935, new node val ap: 0.8173
2024-04-09 10:27:25,751 - root - INFO - train recall: 0.7272, val recall: 0.7270, new node val recall: 0.7505
2024-04-09 10:27:26,440 - root - INFO - start 4 epoch
2024-04-09 10:27:55,167 - root - INFO - epoch: 4
2024-04-09 10:27:55,167 - root - INFO - total memory use: 6606.58 MB
2024-04-09 10:27:55,167 - root - INFO - train time: 9.38 s
2024-04-09 10:27:55,167 - root - INFO - Epoch mean loss: 0.9844887271160032
2024-04-09 10:27:55,167 - root - INFO - train acc: 0.7422, val acc: 0.6895, new node val acc: 0.7105
2024-04-09 10:27:55,168 - root - INFO - train auc: 0.8352, val auc: 0.7723, new node val auc: 0.7966
2024-04-09 10:27:55,168 - root - INFO - train ap: 0.8452, val ap: 0.8013, new node val ap: 0.8269
2024-04-09 10:27:55,168 - root - INFO - train recall: 0.7369, val recall: 0.6995, new node val recall: 0.7266
2024-04-09 10:27:55,858 - root - INFO - start 5 epoch
2024-04-09 10:28:24,585 - root - INFO - epoch: 5
2024-04-09 10:28:24,585 - root - INFO - total memory use: 7927.90 MB
2024-04-09 10:28:24,585 - root - INFO - train time: 6.69 s
2024-04-09 10:28:24,585 - root - INFO - Epoch mean loss: 0.9659809208497768
2024-04-09 10:28:24,585 - root - INFO - train acc: 0.7506, val acc: 0.7063, new node val acc: 0.7176
2024-04-09 10:28:24,585 - root - INFO - train auc: 0.8435, val auc: 0.7913, new node val auc: 0.8087
2024-04-09 10:28:24,585 - root - INFO - train ap: 0.8527, val ap: 0.8158, new node val ap: 0.8346
2024-04-09 10:28:24,585 - root - INFO - train recall: 0.7506, val recall: 0.7366, new node val recall: 0.7537
2024-04-09 10:28:25,211 - root - INFO - start 6 epoch
2024-04-09 10:28:53,276 - root - INFO - epoch: 6
2024-04-09 10:28:53,276 - root - INFO - total memory use: 9249.21 MB
2024-04-09 10:28:53,276 - root - INFO - train time: 5.91 s
2024-04-09 10:28:53,276 - root - INFO - Epoch mean loss: 0.9465887590152461
2024-04-09 10:28:53,276 - root - INFO - train acc: 0.7579, val acc: 0.7047, new node val acc: 0.7118
2024-04-09 10:28:53,277 - root - INFO - train auc: 0.8502, val auc: 0.7911, new node val auc: 0.8025
2024-04-09 10:28:53,277 - root - INFO - train ap: 0.8571, val ap: 0.8143, new node val ap: 0.8285
2024-04-09 10:28:53,277 - root - INFO - train recall: 0.7629, val recall: 0.7513, new node val recall: 0.7683
2024-04-09 10:28:53,891 - root - INFO - start 7 epoch
2024-04-09 10:29:25,015 - root - INFO - epoch: 7
2024-04-09 10:29:25,015 - root - INFO - total memory use: 10570.53 MB
2024-04-09 10:29:25,015 - root - INFO - train time: 7.04 s
2024-04-09 10:29:25,015 - root - INFO - Epoch mean loss: 0.9252372660287996
2024-04-09 10:29:25,015 - root - INFO - train acc: 0.7662, val acc: 0.7151, new node val acc: 0.7230
2024-04-09 10:29:25,015 - root - INFO - train auc: 0.8580, val auc: 0.8045, new node val auc: 0.8169
2024-04-09 10:29:25,015 - root - INFO - train ap: 0.8655, val ap: 0.8264, new node val ap: 0.8415
2024-04-09 10:29:25,015 - root - INFO - train recall: 0.7690, val recall: 0.7765, new node val recall: 0.7903
2024-04-09 10:29:25,699 - root - INFO - start 8 epoch
2024-04-09 10:29:54,838 - root - INFO - epoch: 8
2024-04-09 10:29:54,839 - root - INFO - total memory use: 11891.85 MB
2024-04-09 10:29:54,839 - root - INFO - train time: 6.85 s
2024-04-09 10:29:54,839 - root - INFO - Epoch mean loss: 0.9144601574758204
2024-04-09 10:29:54,839 - root - INFO - train acc: 0.7709, val acc: 0.7281, new node val acc: 0.7297
2024-04-09 10:29:54,839 - root - INFO - train auc: 0.8627, val auc: 0.8160, new node val auc: 0.8236
2024-04-09 10:29:54,839 - root - INFO - train ap: 0.8696, val ap: 0.8343, new node val ap: 0.8442
2024-04-09 10:29:54,839 - root - INFO - train recall: 0.7732, val recall: 0.7739, new node val recall: 0.7894
2024-04-09 10:29:55,509 - root - INFO - start 9 epoch
2024-04-09 10:30:24,356 - root - INFO - epoch: 9
2024-04-09 10:30:24,356 - root - INFO - total memory use: 13213.16 MB
2024-04-09 10:30:24,356 - root - INFO - train time: 6.11 s
2024-04-09 10:30:24,356 - root - INFO - Epoch mean loss: 0.9068940340018854
2024-04-09 10:30:24,356 - root - INFO - train acc: 0.7749, val acc: 0.7298, new node val acc: 0.7300
2024-04-09 10:30:24,356 - root - INFO - train auc: 0.8664, val auc: 0.8157, new node val auc: 0.8206
2024-04-09 10:30:24,356 - root - INFO - train ap: 0.8719, val ap: 0.8324, new node val ap: 0.8406
2024-04-09 10:30:24,356 - root - INFO - train recall: 0.7805, val recall: 0.7779, new node val recall: 0.7910
2024-04-09 10:30:25,026 - root - INFO - start 10 epoch
2024-04-09 10:30:56,524 - root - INFO - epoch: 10
2024-04-09 10:30:56,525 - root - INFO - total memory use: 14534.48 MB
2024-04-09 10:30:56,525 - root - INFO - train time: 9.20 s
2024-04-09 10:30:56,525 - root - INFO - Epoch mean loss: 0.9010383719351234
2024-04-09 10:30:56,525 - root - INFO - train acc: 0.7775, val acc: 0.7277, new node val acc: 0.7381
2024-04-09 10:30:56,525 - root - INFO - train auc: 0.8682, val auc: 0.8174, new node val auc: 0.8297
2024-04-09 10:30:56,525 - root - INFO - train ap: 0.8738, val ap: 0.8366, new node val ap: 0.8502
2024-04-09 10:30:56,525 - root - INFO - train recall: 0.7832, val recall: 0.7730, new node val recall: 0.7896
2024-04-09 10:30:57,185 - root - INFO - start 11 epoch
2024-04-09 10:31:27,979 - root - INFO - epoch: 11
2024-04-09 10:31:27,980 - root - INFO - total memory use: 15855.80 MB
2024-04-09 10:31:27,980 - root - INFO - train time: 8.89 s
2024-04-09 10:31:27,980 - root - INFO - Epoch mean loss: 0.882017029494774
2024-04-09 10:31:27,980 - root - INFO - train acc: 0.7836, val acc: 0.7354, new node val acc: 0.7430
2024-04-09 10:31:27,980 - root - INFO - train auc: 0.8744, val auc: 0.8262, new node val auc: 0.8385
2024-04-09 10:31:27,980 - root - INFO - train ap: 0.8796, val ap: 0.8436, new node val ap: 0.8570
2024-04-09 10:31:27,980 - root - INFO - train recall: 0.7891, val recall: 0.8015, new node val recall: 0.8167
2024-04-09 10:31:28,672 - root - INFO - start 12 epoch
2024-04-09 10:31:58,739 - root - INFO - epoch: 12
2024-04-09 10:31:58,739 - root - INFO - total memory use: 17177.11 MB
2024-04-09 10:31:58,739 - root - INFO - train time: 8.00 s
2024-04-09 10:31:58,739 - root - INFO - Epoch mean loss: 0.8801124750114069
2024-04-09 10:31:58,739 - root - INFO - train acc: 0.7845, val acc: 0.7307, new node val acc: 0.7393
2024-04-09 10:31:58,739 - root - INFO - train auc: 0.8742, val auc: 0.8202, new node val auc: 0.8322
2024-04-09 10:31:58,739 - root - INFO - train ap: 0.8790, val ap: 0.8362, new node val ap: 0.8512
2024-04-09 10:31:58,739 - root - INFO - train recall: 0.7886, val recall: 0.7960, new node val recall: 0.8088
2024-04-09 10:31:59,417 - root - INFO - start 13 epoch
2024-04-09 10:32:29,661 - root - INFO - epoch: 13
2024-04-09 10:32:29,661 - root - INFO - total memory use: 18498.43 MB
2024-04-09 10:32:29,661 - root - INFO - train time: 7.74 s
2024-04-09 10:32:29,661 - root - INFO - Epoch mean loss: 0.8775570130929714
2024-04-09 10:32:29,661 - root - INFO - train acc: 0.7843, val acc: 0.7320, new node val acc: 0.7398
2024-04-09 10:32:29,661 - root - INFO - train auc: 0.8754, val auc: 0.8269, new node val auc: 0.8347
2024-04-09 10:32:29,661 - root - INFO - train ap: 0.8806, val ap: 0.8437, new node val ap: 0.8524
2024-04-09 10:32:29,661 - root - INFO - train recall: 0.7889, val recall: 0.8087, new node val recall: 0.8209
2024-04-09 10:32:30,360 - root - INFO - start 14 epoch
2024-04-09 10:32:58,660 - root - INFO - epoch: 14
2024-04-09 10:32:58,660 - root - INFO - total memory use: 19819.75 MB
2024-04-09 10:32:58,660 - root - INFO - train time: 7.35 s
2024-04-09 10:32:58,660 - root - INFO - Epoch mean loss: 0.8588897091586415
2024-04-09 10:32:58,660 - root - INFO - train acc: 0.7908, val acc: 0.7402, new node val acc: 0.7483
2024-04-09 10:32:58,660 - root - INFO - train auc: 0.8814, val auc: 0.8340, new node val auc: 0.8450
2024-04-09 10:32:58,660 - root - INFO - train ap: 0.8860, val ap: 0.8505, new node val ap: 0.8629
2024-04-09 10:32:58,660 - root - INFO - train recall: 0.7949, val recall: 0.8051, new node val recall: 0.8192
2024-04-09 10:32:59,311 - root - INFO - start 15 epoch
2024-04-09 10:33:21,011 - root - INFO - epoch: 15
2024-04-09 10:33:21,011 - root - INFO - total memory use: 21141.06 MB
2024-04-09 10:33:21,011 - root - INFO - train time: 5.89 s
2024-04-09 10:33:21,011 - root - INFO - Epoch mean loss: 0.857559794332923
2024-04-09 10:33:21,011 - root - INFO - train acc: 0.7915, val acc: 0.7384, new node val acc: 0.7461
2024-04-09 10:33:21,011 - root - INFO - train auc: 0.8816, val auc: 0.8331, new node val auc: 0.8419
2024-04-09 10:33:21,011 - root - INFO - train ap: 0.8859, val ap: 0.8492, new node val ap: 0.8591
2024-04-09 10:33:21,011 - root - INFO - train recall: 0.7971, val recall: 0.8054, new node val recall: 0.8176
2024-04-09 10:33:21,679 - root - INFO - start 16 epoch
2024-04-09 10:33:42,153 - root - INFO - epoch: 16
2024-04-09 10:33:42,153 - root - INFO - total memory use: 22462.38 MB
2024-04-09 10:33:42,153 - root - INFO - train time: 5.52 s
2024-04-09 10:33:42,153 - root - INFO - Epoch mean loss: 0.8504233214913345
2024-04-09 10:33:42,153 - root - INFO - train acc: 0.7929, val acc: 0.7433, new node val acc: 0.7448
2024-04-09 10:33:42,153 - root - INFO - train auc: 0.8834, val auc: 0.8378, new node val auc: 0.8398
2024-04-09 10:33:42,153 - root - INFO - train ap: 0.8875, val ap: 0.8532, new node val ap: 0.8579
2024-04-09 10:33:42,154 - root - INFO - train recall: 0.7973, val recall: 0.8134, new node val recall: 0.8153
2024-04-09 10:33:42,812 - root - INFO - start 17 epoch
2024-04-09 10:34:05,252 - root - INFO - epoch: 17
2024-04-09 10:34:05,253 - root - INFO - total memory use: 23783.69 MB
2024-04-09 10:34:05,253 - root - INFO - train time: 6.82 s
2024-04-09 10:34:05,253 - root - INFO - Epoch mean loss: 0.8477045254009526
2024-04-09 10:34:05,253 - root - INFO - train acc: 0.7933, val acc: 0.7425, new node val acc: 0.7500
2024-04-09 10:34:05,253 - root - INFO - train auc: 0.8841, val auc: 0.8377, new node val auc: 0.8458
2024-04-09 10:34:05,253 - root - INFO - train ap: 0.8891, val ap: 0.8532, new node val ap: 0.8626
2024-04-09 10:34:05,253 - root - INFO - train recall: 0.7965, val recall: 0.8122, new node val recall: 0.8230
2024-04-09 10:34:05,929 - root - INFO - start 18 epoch
2024-04-09 10:34:30,994 - root - INFO - epoch: 18
2024-04-09 10:34:30,995 - root - INFO - total memory use: 25105.01 MB
2024-04-09 10:34:30,995 - root - INFO - train time: 6.57 s
2024-04-09 10:34:30,995 - root - INFO - Epoch mean loss: 0.8402137305678391
2024-04-09 10:34:30,995 - root - INFO - train acc: 0.7974, val acc: 0.7479, new node val acc: 0.7554
2024-04-09 10:34:30,995 - root - INFO - train auc: 0.8867, val auc: 0.8417, new node val auc: 0.8498
2024-04-09 10:34:30,995 - root - INFO - train ap: 0.8899, val ap: 0.8561, new node val ap: 0.8670
2024-04-09 10:34:30,995 - root - INFO - train recall: 0.8030, val recall: 0.8095, new node val recall: 0.8185
2024-04-09 10:34:31,662 - root - INFO - start 19 epoch
2024-04-09 10:34:55,899 - root - INFO - epoch: 19
2024-04-09 10:34:55,899 - root - INFO - total memory use: 26426.33 MB
2024-04-09 10:34:55,899 - root - INFO - train time: 5.91 s
2024-04-09 10:34:55,899 - root - INFO - Epoch mean loss: 0.8355486436588008
2024-04-09 10:34:55,899 - root - INFO - train acc: 0.7978, val acc: 0.7503, new node val acc: 0.7554
2024-04-09 10:34:55,899 - root - INFO - train auc: 0.8881, val auc: 0.8393, new node val auc: 0.8468
2024-04-09 10:34:55,899 - root - INFO - train ap: 0.8924, val ap: 0.8544, new node val ap: 0.8659
2024-04-09 10:34:55,899 - root - INFO - train recall: 0.8005, val recall: 0.7973, new node val recall: 0.8071
2024-04-09 10:34:56,569 - root - INFO - start 20 epoch
2024-04-09 10:35:21,149 - root - INFO - epoch: 20
2024-04-09 10:35:21,149 - root - INFO - total memory use: 27747.64 MB
2024-04-09 10:35:21,149 - root - INFO - train time: 6.61 s
2024-04-09 10:35:21,149 - root - INFO - Epoch mean loss: 0.8340139040132848
2024-04-09 10:35:21,149 - root - INFO - train acc: 0.7976, val acc: 0.7400, new node val acc: 0.7487
2024-04-09 10:35:21,149 - root - INFO - train auc: 0.8887, val auc: 0.8327, new node val auc: 0.8418
2024-04-09 10:35:21,150 - root - INFO - train ap: 0.8925, val ap: 0.8480, new node val ap: 0.8579
2024-04-09 10:35:21,150 - root - INFO - train recall: 0.8010, val recall: 0.8015, new node val recall: 0.8151
2024-04-09 10:35:21,813 - root - INFO - start 21 epoch
2024-04-09 10:35:47,720 - root - INFO - epoch: 21
2024-04-09 10:35:47,720 - root - INFO - total memory use: 29068.96 MB
2024-04-09 10:35:47,720 - root - INFO - train time: 7.73 s
2024-04-09 10:35:47,720 - root - INFO - Epoch mean loss: 0.8324636395384626
2024-04-09 10:35:47,720 - root - INFO - train acc: 0.8000, val acc: 0.7457, new node val acc: 0.7539
2024-04-09 10:35:47,720 - root - INFO - train auc: 0.8893, val auc: 0.8373, new node val auc: 0.8446
2024-04-09 10:35:47,720 - root - INFO - train ap: 0.8932, val ap: 0.8535, new node val ap: 0.8618
2024-04-09 10:35:47,720 - root - INFO - train recall: 0.8031, val recall: 0.8018, new node val recall: 0.8149
2024-04-09 10:35:47,720 - root - INFO - No improvment over 3 epochs, stop training
2024-04-09 10:35:47,720 - root - INFO - Loading the best model at epoch 19
2024-04-09 10:35:47,866 - root - INFO - Loaded the best model at epoch 19 for inference
2024-04-09 10:35:47,866 - root - INFO - early stop total time: 159.92 s
2024-04-09 10:35:47,866 - root - INFO - early stop average time: 7.27 s
2024-04-09 10:35:47,866 - root - INFO - average memory use: 1321.32 MB
2024-04-09 10:36:04,345 - root - INFO - Test statistics: Old nodes -- acc: 0.7284, auc: 0.8134, ap: 0.8284, recall: 0.7846
2024-04-09 10:36:04,345 - root - INFO - Test statistics: New nodes -- acc: 0.7215, auc: 0.8099, ap: 0.8286, recall: 0.7869
2024-04-09 10:36:04,345 - root - INFO - total time: 159.92 s
2024-04-09 10:36:04,345 - root - INFO - complete average time: 7.27 s
2024-04-09 10:36:04,345 - root - INFO - average memory use: 1321.32 MB
2024-04-09 10:36:04,345 - root - INFO - Saving TGAN model
2024-04-09 10:36:04,974 - root - INFO - TGAN models saved
