2024-04-12 14:05:17,088 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='reddit', drop_out=0.1, gpu=2, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=2, node_dim=100, prefix='reddit-2l', time='time', time_dim=100, uniform=True)
2024-04-12 14:05:21,346 - module - INFO - Aggregation uses attention model
2024-04-12 14:05:21,362 - module - INFO - Using scaled prod attention
2024-04-12 14:05:21,377 - module - INFO - Using scaled prod attention
2024-04-12 14:05:21,377 - module - INFO - Using time encoding
2024-04-12 14:05:23,225 - root - INFO - num of training instances: 389989
2024-04-12 14:05:23,226 - root - INFO - num of batches per epoch: 390
2024-04-12 14:05:23,237 - root - INFO - start 0 epoch
2024-04-12 14:26:59,041 - root - INFO - epoch: 0
2024-04-12 14:26:59,041 - root - INFO - total memory use: 12408.31 MB
2024-04-12 14:26:59,041 - root - INFO - train time: 715.07 s
2024-04-12 14:26:59,041 - root - INFO - Epoch mean loss: 0.6702003948199443
2024-04-12 14:26:59,041 - root - INFO - train acc: 0.8532, val acc: 0.8929, new node val acc: 0.8759
2024-04-12 14:26:59,041 - root - INFO - train auc: 0.9257, val auc: 0.9620, new node val auc: 0.9489
2024-04-12 14:26:59,041 - root - INFO - train ap: 0.9207, val ap: 0.9627, new node val ap: 0.9491
2024-04-12 14:26:59,041 - root - INFO - train recall: 0.8758, val recall: 0.9344, new node val recall: 0.9193
2024-04-12 14:27:01,675 - root - INFO - start 1 epoch
2024-04-12 14:52:26,095 - root - INFO - epoch: 1
2024-04-12 14:52:26,095 - root - INFO - total memory use: 24816.61 MB
2024-04-12 14:52:26,095 - root - INFO - train time: 987.40 s
2024-04-12 14:52:26,096 - root - INFO - Epoch mean loss: 0.49414604069330753
2024-04-12 14:52:26,096 - root - INFO - train acc: 0.8986, val acc: 0.9039, new node val acc: 0.8876
2024-04-12 14:52:26,096 - root - INFO - train auc: 0.9631, val auc: 0.9688, new node val auc: 0.9566
2024-04-12 14:52:26,096 - root - INFO - train ap: 0.9638, val ap: 0.9701, new node val ap: 0.9568
2024-04-12 14:52:26,096 - root - INFO - train recall: 0.9065, val recall: 0.9419, new node val recall: 0.9290
2024-04-12 14:52:29,479 - root - INFO - start 2 epoch
2024-04-12 15:18:00,142 - root - INFO - epoch: 2
2024-04-12 15:18:00,143 - root - INFO - total memory use: 37224.92 MB
2024-04-12 15:18:00,143 - root - INFO - train time: 1002.03 s
2024-04-12 15:18:00,143 - root - INFO - Epoch mean loss: 0.4627102243594634
2024-04-12 15:18:00,143 - root - INFO - train acc: 0.9053, val acc: 0.9127, new node val acc: 0.8949
2024-04-12 15:18:00,143 - root - INFO - train auc: 0.9672, val auc: 0.9722, new node val auc: 0.9607
2024-04-12 15:18:00,143 - root - INFO - train ap: 0.9683, val ap: 0.9735, new node val ap: 0.9616
2024-04-12 15:18:00,143 - root - INFO - train recall: 0.9106, val recall: 0.9391, new node val recall: 0.9223
2024-04-12 15:18:02,742 - root - INFO - start 3 epoch
2024-04-12 15:45:27,112 - root - INFO - epoch: 3
2024-04-12 15:45:27,112 - root - INFO - total memory use: 49633.23 MB
2024-04-12 15:45:27,112 - root - INFO - train time: 1130.10 s
2024-04-12 15:45:27,113 - root - INFO - Epoch mean loss: 0.4463515980121417
2024-04-12 15:45:27,113 - root - INFO - train acc: 0.9093, val acc: 0.9140, new node val acc: 0.8980
2024-04-12 15:45:27,113 - root - INFO - train auc: 0.9700, val auc: 0.9737, new node val auc: 0.9630
2024-04-12 15:45:27,113 - root - INFO - train ap: 0.9711, val ap: 0.9749, new node val ap: 0.9636
2024-04-12 15:45:27,113 - root - INFO - train recall: 0.9127, val recall: 0.9413, new node val recall: 0.9227
2024-04-12 15:45:31,007 - root - INFO - start 4 epoch
2024-04-12 16:09:41,274 - root - INFO - epoch: 4
2024-04-12 16:09:41,275 - root - INFO - total memory use: 62041.53 MB
2024-04-12 16:09:41,275 - root - INFO - train time: 1117.66 s
2024-04-12 16:09:41,275 - root - INFO - Epoch mean loss: 0.4302006376859469
2024-04-12 16:09:41,275 - root - INFO - train acc: 0.9128, val acc: 0.9188, new node val acc: 0.8999
2024-04-12 16:09:41,275 - root - INFO - train auc: 0.9716, val auc: 0.9755, new node val auc: 0.9640
2024-04-12 16:09:41,275 - root - INFO - train ap: 0.9726, val ap: 0.9767, new node val ap: 0.9646
2024-04-12 16:09:41,275 - root - INFO - train recall: 0.9147, val recall: 0.9397, new node val recall: 0.9227
2024-04-12 16:09:43,871 - root - INFO - start 5 epoch
2024-04-12 16:33:09,324 - root - INFO - epoch: 5
2024-04-12 16:33:09,325 - root - INFO - total memory use: 74449.84 MB
2024-04-12 16:33:09,325 - root - INFO - train time: 964.41 s
2024-04-12 16:33:09,325 - root - INFO - Epoch mean loss: 0.4160554086550688
2024-04-12 16:33:09,325 - root - INFO - train acc: 0.9158, val acc: 0.9200, new node val acc: 0.9058
2024-04-12 16:33:09,325 - root - INFO - train auc: 0.9731, val auc: 0.9761, new node val auc: 0.9672
2024-04-12 16:33:09,326 - root - INFO - train ap: 0.9742, val ap: 0.9773, new node val ap: 0.9679
2024-04-12 16:33:09,326 - root - INFO - train recall: 0.9165, val recall: 0.9373, new node val recall: 0.9193
2024-04-12 16:33:12,943 - root - INFO - start 6 epoch
2024-04-12 16:50:32,529 - root - INFO - epoch: 6
2024-04-12 16:50:32,529 - root - INFO - total memory use: 86858.15 MB
2024-04-12 16:50:32,529 - root - INFO - train time: 706.12 s
2024-04-12 16:50:32,529 - root - INFO - Epoch mean loss: 0.4078854030523545
2024-04-12 16:50:32,529 - root - INFO - train acc: 0.9178, val acc: 0.9220, new node val acc: 0.9084
2024-04-12 16:50:32,529 - root - INFO - train auc: 0.9742, val auc: 0.9774, new node val auc: 0.9677
2024-04-12 16:50:32,529 - root - INFO - train ap: 0.9752, val ap: 0.9786, new node val ap: 0.9677
2024-04-12 16:50:32,530 - root - INFO - train recall: 0.9183, val recall: 0.9410, new node val recall: 0.9250
2024-04-12 16:50:35,109 - root - INFO - start 7 epoch
2024-04-12 17:06:14,041 - root - INFO - epoch: 7
2024-04-12 17:06:14,041 - root - INFO - total memory use: 99266.45 MB
2024-04-12 17:06:14,041 - root - INFO - train time: 604.58 s
2024-04-12 17:06:14,041 - root - INFO - Epoch mean loss: 0.39946509240529476
2024-04-12 17:06:14,041 - root - INFO - train acc: 0.9197, val acc: 0.9235, new node val acc: 0.9058
2024-04-12 17:06:14,041 - root - INFO - train auc: 0.9750, val auc: 0.9777, new node val auc: 0.9671
2024-04-12 17:06:14,041 - root - INFO - train ap: 0.9760, val ap: 0.9788, new node val ap: 0.9681
2024-04-12 17:06:14,041 - root - INFO - train recall: 0.9196, val recall: 0.9401, new node val recall: 0.9202
2024-04-12 17:06:16,721 - root - INFO - start 8 epoch
2024-04-12 17:24:00,622 - root - INFO - epoch: 8
2024-04-12 17:24:00,622 - root - INFO - total memory use: 111674.76 MB
2024-04-12 17:24:00,622 - root - INFO - train time: 607.45 s
2024-04-12 17:24:00,623 - root - INFO - Epoch mean loss: 0.3921001741519341
2024-04-12 17:24:00,623 - root - INFO - train acc: 0.9208, val acc: 0.9267, new node val acc: 0.9075
2024-04-12 17:24:00,623 - root - INFO - train auc: 0.9758, val auc: 0.9786, new node val auc: 0.9673
2024-04-12 17:24:00,623 - root - INFO - train ap: 0.9768, val ap: 0.9798, new node val ap: 0.9685
2024-04-12 17:24:00,623 - root - INFO - train recall: 0.9204, val recall: 0.9326, new node val recall: 0.9102
2024-04-12 17:24:03,996 - root - INFO - start 9 epoch
2024-04-12 17:48:32,231 - root - INFO - epoch: 9
2024-04-12 17:48:32,231 - root - INFO - total memory use: 124083.07 MB
2024-04-12 17:48:32,231 - root - INFO - train time: 993.51 s
2024-04-12 17:48:32,231 - root - INFO - Epoch mean loss: 0.3852663875390322
2024-04-12 17:48:32,231 - root - INFO - train acc: 0.9226, val acc: 0.9262, new node val acc: 0.9083
2024-04-12 17:48:32,232 - root - INFO - train auc: 0.9766, val auc: 0.9792, new node val auc: 0.9689
2024-04-12 17:48:32,232 - root - INFO - train ap: 0.9777, val ap: 0.9802, new node val ap: 0.9700
2024-04-12 17:48:32,232 - root - INFO - train recall: 0.9214, val recall: 0.9391, new node val recall: 0.9183
2024-04-12 17:48:35,895 - root - INFO - start 10 epoch
2024-04-12 18:12:52,918 - root - INFO - epoch: 10
2024-04-12 18:12:52,919 - root - INFO - total memory use: 136491.37 MB
2024-04-12 18:12:52,919 - root - INFO - train time: 1092.16 s
2024-04-12 18:12:52,919 - root - INFO - Epoch mean loss: 0.38086313269077204
2024-04-12 18:12:52,919 - root - INFO - train acc: 0.9233, val acc: 0.9250, new node val acc: 0.9075
2024-04-12 18:12:52,919 - root - INFO - train auc: 0.9771, val auc: 0.9791, new node val auc: 0.9687
2024-04-12 18:12:52,919 - root - INFO - train ap: 0.9780, val ap: 0.9802, new node val ap: 0.9699
2024-04-12 18:12:52,919 - root - INFO - train recall: 0.9221, val recall: 0.9458, new node val recall: 0.9287
2024-04-12 18:12:55,415 - root - INFO - start 11 epoch
2024-04-12 18:34:07,702 - root - INFO - epoch: 11
2024-04-12 18:34:07,702 - root - INFO - total memory use: 148899.68 MB
2024-04-12 18:34:07,703 - root - INFO - train time: 921.80 s
2024-04-12 18:34:07,703 - root - INFO - Epoch mean loss: 0.37587973918670264
2024-04-12 18:34:07,703 - root - INFO - train acc: 0.9245, val acc: 0.9278, new node val acc: 0.9089
2024-04-12 18:34:07,703 - root - INFO - train auc: 0.9776, val auc: 0.9800, new node val auc: 0.9696
2024-04-12 18:34:07,703 - root - INFO - train ap: 0.9786, val ap: 0.9812, new node val ap: 0.9708
2024-04-12 18:34:07,703 - root - INFO - train recall: 0.9230, val recall: 0.9417, new node val recall: 0.9255
2024-04-12 18:34:10,336 - root - INFO - start 12 epoch
2024-04-12 18:49:41,629 - root - INFO - epoch: 12
2024-04-12 18:49:41,630 - root - INFO - total memory use: 161307.99 MB
2024-04-12 18:49:41,630 - root - INFO - train time: 594.91 s
2024-04-12 18:49:41,630 - root - INFO - Epoch mean loss: 0.372449280665471
2024-04-12 18:49:41,630 - root - INFO - train acc: 0.9250, val acc: 0.9289, new node val acc: 0.9100
2024-04-12 18:49:41,630 - root - INFO - train auc: 0.9779, val auc: 0.9803, new node val auc: 0.9701
2024-04-12 18:49:41,630 - root - INFO - train ap: 0.9789, val ap: 0.9814, new node val ap: 0.9714
2024-04-12 18:49:41,630 - root - INFO - train recall: 0.9234, val recall: 0.9378, new node val recall: 0.9172
2024-04-12 18:49:44,140 - root - INFO - start 13 epoch
2024-04-12 19:05:17,841 - root - INFO - epoch: 13
2024-04-12 19:05:17,842 - root - INFO - total memory use: 173716.29 MB
2024-04-12 19:05:17,842 - root - INFO - train time: 596.86 s
2024-04-12 19:05:17,842 - root - INFO - Epoch mean loss: 0.36727425165665456
2024-04-12 19:05:17,842 - root - INFO - train acc: 0.9264, val acc: 0.9298, new node val acc: 0.9113
2024-04-12 19:05:17,842 - root - INFO - train auc: 0.9785, val auc: 0.9807, new node val auc: 0.9695
2024-04-12 19:05:17,842 - root - INFO - train ap: 0.9794, val ap: 0.9819, new node val ap: 0.9699
2024-04-12 19:05:17,842 - root - INFO - train recall: 0.9242, val recall: 0.9338, new node val recall: 0.9136
2024-04-12 19:05:20,244 - root - INFO - start 14 epoch
2024-04-12 19:32:55,954 - root - INFO - epoch: 14
2024-04-12 19:32:55,954 - root - INFO - total memory use: 186124.60 MB
2024-04-12 19:32:55,954 - root - INFO - train time: 881.16 s
2024-04-12 19:32:55,954 - root - INFO - Epoch mean loss: 0.366388246569878
2024-04-12 19:32:55,954 - root - INFO - train acc: 0.9263, val acc: 0.9304, new node val acc: 0.9121
2024-04-12 19:32:55,954 - root - INFO - train auc: 0.9786, val auc: 0.9809, new node val auc: 0.9710
2024-04-12 19:32:55,954 - root - INFO - train ap: 0.9794, val ap: 0.9821, new node val ap: 0.9721
2024-04-12 19:32:55,955 - root - INFO - train recall: 0.9246, val recall: 0.9384, new node val recall: 0.9171
2024-04-12 19:32:55,955 - root - INFO - No improvment over 3 epochs, stop training
2024-04-12 19:32:55,955 - root - INFO - Loading the best model at epoch 12
2024-04-12 19:32:56,725 - root - INFO - Loaded the best model at epoch 12 for inference
2024-04-12 19:32:56,726 - root - INFO - early stop total time: 12915.20 s
2024-04-12 19:32:56,726 - root - INFO - early stop average time: 861.01 s
2024-04-12 19:32:56,726 - root - INFO - average memory use: 12408.31 MB
2024-04-12 19:43:48,016 - root - INFO - Test statistics: Old nodes -- acc: 0.9274, auc: 0.9798, ap: 0.9809, recall: 0.9399
2024-04-12 19:43:48,016 - root - INFO - Test statistics: New nodes -- acc: 0.8985, auc: 0.9636, ap: 0.9647, recall: 0.9193
2024-04-12 19:43:48,016 - root - INFO - total time: 12915.20 s
2024-04-12 19:43:48,016 - root - INFO - complete average time: 861.01 s
2024-04-12 19:43:48,016 - root - INFO - average memory use: 12408.31 MB
2024-04-12 19:43:48,016 - root - INFO - Saving TGAN model
2024-04-12 19:43:50,469 - root - INFO - TGAN models saved
