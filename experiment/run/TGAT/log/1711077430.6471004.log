2024-03-22 11:17:10,647 - root - INFO - Namespace(agg_method='attn', attn_mode='prod', bs=1000, data='Flights', drop_out=0.1, gpu=3, lr=0.0001, n_degree=20, n_epoch=50, n_head=2, n_layer=1, node_dim=100, prefix='flight', time='time', time_dim=100, uniform=True)
2024-03-22 11:17:20,229 - module - INFO - Aggregation uses attention model
2024-03-22 11:17:20,242 - module - INFO - Using scaled prod attention
2024-03-22 11:17:20,242 - module - INFO - Using time encoding
2024-03-22 11:17:21,456 - root - INFO - num of training instances: 1102788
2024-03-22 11:17:21,456 - root - INFO - num of batches per epoch: 1103
2024-03-22 11:17:21,487 - root - INFO - start 0 epoch
2024-03-22 11:20:02,130 - root - INFO - epoch: 0
2024-03-22 11:20:02,130 - root - INFO - train time: 61.57 s
2024-03-22 11:20:02,130 - root - INFO - Epoch mean loss: 1.0853653539340278
2024-03-22 11:20:02,130 - root - INFO - train acc: 0.7183, val acc: 0.6386, new node val acc: 0.6420
2024-03-22 11:20:02,130 - root - INFO - train auc: 0.7721, val auc: 0.7022, new node val auc: 0.7031
2024-03-22 11:20:02,130 - root - INFO - train ap: 0.7206, val ap: 0.6792, new node val ap: 0.6803
2024-03-22 11:20:02,130 - root - INFO - train recall: 0.8268, val recall: 0.6651, new node val recall: 0.6698
2024-03-22 11:20:06,549 - root - INFO - start 1 epoch
2024-03-22 11:22:46,822 - root - INFO - epoch: 1
2024-03-22 11:22:46,822 - root - INFO - train time: 60.94 s
2024-03-22 11:22:46,822 - root - INFO - Epoch mean loss: 1.0744983388528107
2024-03-22 11:22:46,822 - root - INFO - train acc: 0.7226, val acc: 0.6406, new node val acc: 0.6422
2024-03-22 11:22:46,822 - root - INFO - train auc: 0.7776, val auc: 0.7027, new node val auc: 0.7039
2024-03-22 11:22:46,823 - root - INFO - train ap: 0.7269, val ap: 0.6795, new node val ap: 0.6820
2024-03-22 11:22:46,823 - root - INFO - train recall: 0.8326, val recall: 0.6800, new node val recall: 0.6827
2024-03-22 11:22:51,284 - root - INFO - start 2 epoch
2024-03-22 11:25:31,443 - root - INFO - epoch: 2
2024-03-22 11:25:31,444 - root - INFO - train time: 60.81 s
2024-03-22 11:25:31,444 - root - INFO - Epoch mean loss: 1.0748588570333673
2024-03-22 11:25:31,444 - root - INFO - train acc: 0.7232, val acc: 0.6287, new node val acc: 0.6278
2024-03-22 11:25:31,444 - root - INFO - train auc: 0.7770, val auc: 0.7029, new node val auc: 0.7003
2024-03-22 11:25:31,444 - root - INFO - train ap: 0.7261, val ap: 0.6792, new node val ap: 0.6777
2024-03-22 11:25:31,444 - root - INFO - train recall: 0.8358, val recall: 0.5717, new node val recall: 0.5712
2024-03-22 11:25:35,911 - root - INFO - start 3 epoch
2024-03-22 11:28:16,307 - root - INFO - epoch: 3
2024-03-22 11:28:16,307 - root - INFO - train time: 60.97 s
2024-03-22 11:28:16,307 - root - INFO - Epoch mean loss: 1.0720455809711653
2024-03-22 11:28:16,307 - root - INFO - train acc: 0.7240, val acc: 0.6254, new node val acc: 0.6267
2024-03-22 11:28:16,307 - root - INFO - train auc: 0.7792, val auc: 0.7032, new node val auc: 0.7031
2024-03-22 11:28:16,307 - root - INFO - train ap: 0.7286, val ap: 0.6795, new node val ap: 0.6801
2024-03-22 11:28:16,307 - root - INFO - train recall: 0.8345, val recall: 0.5515, new node val recall: 0.5528
2024-03-22 11:28:16,307 - root - INFO - No improvment over 3 epochs, stop training
2024-03-22 11:28:16,307 - root - INFO - Loading the best model at epoch 0
2024-03-22 11:28:17,660 - root - INFO - Loaded the best model at epoch 0 for inference
2024-03-22 11:28:17,660 - root - INFO - early stop total time: 244.29 s
2024-03-22 11:28:17,660 - root - INFO - early stop average time: 61.07 s
2024-03-22 11:29:43,003 - root - INFO - Test statistics: Old nodes -- acc: 0.6373, auc: 0.6994, ap: 0.6796, recall: 0.6569
2024-03-22 11:29:43,004 - root - INFO - Test statistics: New nodes -- acc: 0.5548, auc: 0.5861, ap: 0.5951, recall: 0.6558
2024-03-22 11:29:43,004 - root - INFO - memory use: 5371.32 MB
2024-03-22 11:29:43,004 - root - INFO - total time: 244.29 s
2024-03-22 11:29:43,004 - root - INFO - complete average time: 61.07 s
2024-03-22 11:29:43,004 - root - INFO - Saving TGAN model
2024-03-22 11:29:47,566 - root - INFO - TGAN models saved
